<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุญุงุณุจุฉ ุฌุฏูู ูุดุฑูุน ุชุฑุจูุฉ ุงูุฃุบูุงู - ูุตุฑ</title>
    <style>
        /* Chart.js styling */
        .chart-container {
            position: relative;
            height: 300px;
            margin: 15px 0;
        }
        
        .chart-section {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 15px;
        }
        
        .chart-section h3 {
            color: #2c3e50;
            margin-bottom: 10px;
            text-align: center;
        }
        
        /* Data management controls */
        .data-controls {
            background: #34495e;
            color: white;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .data-controls button {
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            background: #3498db;
            color: white;
            cursor: pointer;
            font-size: 0.8rem;
            transition: background 0.3s;
        }
        
        .data-controls button:hover {
            background: #2980b9;
        }
        
        .data-controls input[type="file"] {
            display: none;
        }
        
        /* Export modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        
        .modal-content {
            background-color: white;
            margin: 15% auto;
            padding: 20px;
            border-radius: 8px;
            width: 80%;
            max-width: 500px;
            direction: rtl;
        }
        
        .close {
            color: #aaa;
            float: left;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .close:hover {
            color: black;
        }
        
        /* Print styles */
        @media print {
            .tabs, .data-controls {
                display: none;
            }
            
            .tab-content {
                display: block !important;
                page-break-inside: avoid;
            }
            
            .chart-container {
                height: 200px;
            }
        }
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Arial, sans-serif;
            background: #f5f5f5;
            color: #333;
            line-height: 1.4;
            direction: rtl;
            font-size: 14px;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 10px;
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.3rem;
        }
        
        .tabs {
            display: flex;
            background: white;
            border-radius: 8px 8px 0 0;
            overflow-x: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: -1px;
            justify-content: stretch;
            flex-wrap: nowrap;
        }
        
        .tab {
            flex: 1 1 auto;
            min-width: 0;
            padding: 5px 2px;
            text-align: center;
            cursor: pointer;
            background: #ecf0f1;
            border: none;
            border-right: 1px solid #bdc3c7;
            font-size: 0.65rem;
            font-weight: bold;
            transition: all 0.3s;
            white-space: normal;
            line-height: 1.2;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 35px;
        }
        
        .tab:last-child {
            border-right: none;
        }
        
        .tab.active {
            background: white;
            color: #3498db;
            border-bottom: 3px solid #3498db;
            font-weight: bold;
            border-right-color: transparent;
        }
        
        .tab.active + .tab {
            border-left: 1px solid transparent;
        }
        
        .tab:hover {
            background: #d5dbdb;
            position: relative;
            z-index: 1;
            transform: translateY(-1px);
        }
        
        .tab-content {
            display: none;
            background: white;
            padding: 10px;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .tab-content.active {
            display: block;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 8px;
            margin-bottom: 15px;
        }
        
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 6px;
        }
        
        .grid-3 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 6px;
        }
        
        .grid-4 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 6px;
        }
        
        .section {
            background: #f8f9fa;
            border-radius: 6px;
            padding: 10px;
            border: 1px solid #e9ecef;
        }
        
        .section h3 {
            color: #495057;
            margin-bottom: 6px;
            font-size: 0.95rem;
            border-bottom: 2px solid #3498db;
            padding-bottom: 3px;
        }
        
        .input-group {
            margin-bottom: 6px;
        }
        
        .input-group-inline {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 6px;
        }
        
        label {
            display: block;
            margin-bottom: 3px;
            color: #555;
            font-weight: 500;
            font-size: 0.7rem;
        }
        
        input[type="number"], select {
            width: 100%;
            padding: 4px;
            border: 1px solid #ddd;
            border-radius: 3px;
            font-size: 12px;
            transition: border-color 0.3s;
            direction: ltr;
            text-align: right;
        }
        
        input[type="number"]:focus, select:focus {
            outline: none;
            border-color: #3498db;
        }
        
        .result {
            background: #e8f4f8;
            padding: 6px 8px;
            border-radius: 4px;
            margin-top: 6px;
            font-weight: bold;
            color: #2c3e50;
            font-size: 0.85rem;
        }
        
        .summary-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }
        
        .summary-section h2 {
            color: white;
            margin-bottom: 12px;
            text-align: center;
            font-size: 1.3rem;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 10px;
            margin-bottom: 12px;
        }
        
        .metric {
            background: rgba(255,255,255,0.15);
            padding: 8px;
            border-radius: 6px;
            text-align: center;
        }
        
        .metric-label {
            font-size: 0.85rem;
            margin-bottom: 6px;
            opacity: 0.9;
        }
        
        .metric-value {
            font-size: 1.3rem;
            font-weight: bold;
        }
        
        .decision-box {
            text-align: center;
            padding: 10px;
            margin-top: 8px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
        }
        
        .decision-box.go {
            background: #27ae60;
            color: white;
        }
        
        .decision-box.no-go {
            background: #e74c3c;
            color: white;
        }
        
        .decision-box.maybe {
            background: #f39c12;
            color: white;
        }
        
        .info-box {
            background: #fff3cd;
            border: 1px solid #ffecc0;
            padding: 8px;
            border-radius: 4px;
            margin-bottom: 10px;
            color: #856404;
            font-size: 0.8rem;
        }
        
        .compact-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 4px;
        }
        
        .compact-input {
            display: flex;
            flex-direction: column;
        }
        
        .compact-input label {
            font-size: 0.65rem;
            margin-bottom: 2px;
        }
        
        .compact-input input, .compact-input select {
            padding: 4px;
            font-size: 11px;
        }
        
        .section-compact {
            background: #f8f9fa;
            border-radius: 5px;
            padding: 8px;
            border: 1px solid #e9ecef;
        }
        
        .section-compact h3 {
            font-size: 0.9rem;
            margin-bottom: 6px;
            padding-bottom: 3px;
        }
        
        .quick-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 6px;
            margin-bottom: 12px;
        }
        
        .stat-box {
            background: #3498db;
            color: white;
            padding: 6px;
            border-radius: 4px;
            text-align: center;
        }
        
        .stat-box .value {
            font-size: 1rem;
            font-weight: bold;
        }
        
        .stat-box .label {
            font-size: 0.7rem;
            opacity: 0.9;
        }
        
        .small-text {
            font-size: 0.65rem;
            color: #777;
            display: block;
            margin-top: 2px;
        }
        
        @media (max-width: 768px) {
            .tab {
                font-size: 0.6rem;
                padding: 4px 2px;
            }
            
            h1 {
                font-size: 1.2rem;
            }
        }
        
        @media (min-width: 769px) and (max-width: 1024px) {
            .tab {
                font-size: 0.65rem;
                padding: 5px 2px;
            }
        }
        
        @media (min-width: 1025px) and (max-width: 1200px) {
            .tab {
                font-size: 0.7rem;
                padding: 6px 3px;
            }
        }
        
        @media (min-width: 1201px) {
            .tab {
                font-size: 0.75rem;
                padding: 8px 4px;
            }
            
            .grid {
                grid-template-columns: repeat(3, 1fr);
            }
            .grid-2 {
                grid-template-columns: repeat(2, 1fr);
            }
            .grid-3 {
                grid-template-columns: repeat(3, 1fr);
            }
            .grid-4 {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        
        @media (min-width: 1401px) {
            .tab {
                font-size: 0.8rem;
                padding: 10px 5px;
            }
        }
    </style>
    <!-- Chart.js library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- jsPDF library for PDF export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>๐ ุญุงุณุจุฉ ุฌุฏูู ูุดุฑูุน ุชุฑุจูุฉ ุงูุฃุบูุงู - ูุตุฑ</h1>
        
        <!-- Data Management Controls -->
        <div class="data-controls">
            <button onclick="saveProject()">๐พ ุญูุธ ุงููุดุฑูุน</button>
            <button onclick="document.getElementById('loadFile').click()">๐ ุชุญููู ูุดุฑูุน</button>
            <input type="file" id="loadFile" accept=".json" onchange="loadProject(event)">
            <button onclick="exportToPDF()">๐ ุชุตุฏูุฑ PDF</button>
            <button onclick="exportToExcel()">๐ ุชุตุฏูุฑ Excel</button>
            <button onclick="window.print()">๐จ๏ธ ุทุจุงุนุฉ</button>
            <button onclick="showModal('reportModal')">๐ ุชูุฑูุฑ ููุตู</button>
        </div>
        
        <!-- Quick Summary Dashboard -->
        <div id="quickSummary" style="background: #2c3e50; color: white; padding: 8px; border-radius: 6px; margin-bottom: 10px; display: none;">
            <div class="quick-stats">
                <div class="stat-box" style="background: #27ae60;">
                    <div class="value" id="quickProfit">0</div>
                    <div class="label">ุตุงูู ุงูุฑุจุญ</div>
                </div>
                <div class="stat-box" style="background: #e74c3c;">
                    <div class="value" id="quickInvestment">0</div>
                    <div class="label">ุงูุงุณุชุซูุงุฑ</div>
                </div>
                <div class="stat-box" style="background: #f39c12;">
                    <div class="value" id="quickROI">0%</div>
                    <div class="label">ุงูุนุงุฆุฏ</div>
                </div>
                <div class="stat-box" style="background: #9b59b6;">
                    <div class="value" id="quickBreakeven">0</div>
                    <div class="label">ุงูุชุนุงุฏู/ุดูุฑ</div>
                </div>
                <div class="stat-box" style="background: #34495e;">
                    <div class="value" id="quickRevenue">0</div>
                    <div class="label">ุงูุฅูุฑุงุฏุงุช</div>
                </div>
                <div class="stat-box" style="background: #16a085;">
                    <div class="value" id="quickMargin">0%</div>
                    <div class="label">ูุงูุด ุงูุฑุจุญ</div>
                </div>
            </div>
        </div>
        
        <div class="tabs">
            <button class="tab active" onclick="showTab('market')">ุจุญุซ ุงูุณูู</button>
            <button class="tab" onclick="showTab('livestock')">ุจูุงูุงุช ุงูุฃุบูุงู</button>
            <button class="tab" onclick="showTab('infrastructure')">ุงูุจููุฉ ุงูุชุญุชูุฉ</button>
            <button class="tab" onclick="showTab('operations')">ุงูุชุดุบูู</button>
            <button class="tab" onclick="showTab('breeding')">ุจุฑูุงูุฌ ุงูุชุฑุจูุฉ</button>
            <button class="tab" onclick="showTab('risks')">ุงููุฎุงุทุฑ ูุงูุถุฑุงุฆุจ</button>
            <button class="tab" onclick="showTab('seasonal')">ุงูุชุญููู ุงูููุณูู</button>
            <button class="tab" onclick="showTab('financial')">ุงูุชุญููู ุงููุงูู</button>
            <button class="tab" onclick="showTab('multiyear')">ุงูุชุฎุทูุท ูุชุนุฏุฏ ุงูุณููุงุช</button>
            <button class="tab" onclick="showTab('feedOptimizer')">ูุญุณู ุงูุฃุนูุงู</button>
            <button class="tab" onclick="showTab('breedingCalendar')">ุชูููู ุงูุชุฑุจูุฉ</button>
            <button class="tab" onclick="showTab('sensitivity')">ุชุญููู ุงูุญุณุงุณูุฉ</button>
            <button class="tab" onclick="showTab('marketIntel')">ุฐูุงุก ุงูุณูู</button>
            <button class="tab" onclick="showTab('compliance')">ุงูุงูุชุฒุงูุงุช</button>
            <button class="tab" onclick="showTab('operations')">ุฃุฏูุงุช ุชุดุบูููุฉ</button>
        </div>
        
        <!-- ุจุญุซ ุงูุณูู -->
        <div id="market" class="tab-content active">
            <div class="info-box">
                ๐ ุงุฏุฎู ูุนูููุงุช ุงูุณูู ุงููุญููุฉ ูููุทูุชู ููุญุตูู ุนูู ุชุญููู ุฏููู
            </div>
            
            <div class="grid">
                <div class="section">
                    <h3>ุฃุณุนุงุฑ ุงูุจูุน</h3>
                    <div class="input-group">
                        <label>ุณุนุฑ ุฎุฑูู ุงูุฃุถุญูุฉ (ุฌููู)</label>
                        <input type="number" id="udheyaPrice" value="8000">
                        <span class="small-text">ูุชูุณุท ุงูุณุนุฑ ูู ููุณู ุงูุฃุถุญู</span>
                    </div>
                    <div class="input-group">
                        <label>ุณุนุฑ ูููู ุงููุญู (ุฌููู)</label>
                        <input type="number" id="meatPrice" value="250">
                    </div>
                    <div class="input-group">
                        <label>ุณุนุฑ ุงูุฎุฑูู ุงูุญู ููุจูุน (ุฌููู)</label>
                        <input type="number" id="liveAnimalPrice" value="6000">
                        <span class="small-text">ููููุงุณุจุงุช ูุงูุฃูุฑุงุญ</span>
                    </div>
                    <div class="input-group">
                        <label>ุณุนุฑ ูุฌุจุฉ ุงููุงุชุฑููุฌ/ุดุฎุต (ุฌููู)</label>
                        <input type="number" id="cateringPrice" value="150">
                    </div>
                    <div class="input-group">
                        <label>ุณุนุฑ ุฅูุฌุงุฑ ุงูุฎุฑูู ููููุงุณุจุงุช (ุฌููู/ููู)</label>
                        <input type="number" id="eventRentalPrice" value="500">
                    </div>
                    <div class="input-group">
                        <label>ุณุนุฑ ุจูุน ุงูุณูุงุฏ ุงูุนุถูู/ุทู</label>
                        <input type="number" id="manurePrice" value="300">
                    </div>
                    <div class="input-group">
                        <label>ุณุนุฑ ุจูุน ุงูุฌูุฏ/ูุทุนุฉ</label>
                        <input type="number" id="hidePrice" value="150">
                    </div>
                    <div class="input-group">
                        <label>ุณุนุฑ ุงูุชุตุฏูุฑ ููุฎููุฌ/ุฎุฑูู</label>
                        <input type="number" id="exportPrice" value="12000">
                    </div>
                </div>
                
                <div class="section">
                    <h3>ูุนูููุงุช ุงูุณูู</h3>
                    <div class="input-group">
                        <label>ููุน ุงูุณูู ุงููุณุชูุฏู</label>
                        <select id="marketType">
                            <option value="local">ูุญูู</option>
                            <option value="regional">ุฅููููู</option>
                            <option value="online">ุฃูููุงูู</option>
                            <option value="mixed">ูุฎุชูุท</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>ูุชูุณุท ุณุนุฑ ุงูููุงูุณูู (ุฎุฑูู ุฃุถุญูุฉ)</label>
                        <input type="number" id="competitorPrice" value="7500">
                    </div>
                    <div class="input-group">
                        <label>ุนุฏุฏ ุงูููุงูุณูู ูู ุงูููุทูุฉ</label>
                        <input type="number" id="competitors" value="5">
                    </div>
                    <div class="input-group">
                        <label>ูุณุจุฉ ุงูุนููุงุก ุงูููุฏู (%)</label>
                        <input type="number" id="cashCustomers" value="60">
                    </div>
                    <div class="input-group">
                        <label>ูุณุจุฉ ุงูุนููุงุก ุงูุขุฌู (%)</label>
                        <input type="number" id="creditCustomers" value="40" readonly>
                    </div>
                    <div class="input-group">
                        <label>ูุชูุณุท ูุชุฑุฉ ุงูุชุญุตูู (ููู)</label>
                        <input type="number" id="collectionPeriod" value="30">
                    </div>
                    <div class="input-group">
                        <label>ูุณุจุฉ ุงููุญูู ุงูููุชุงุฒุฉ (%)</label>
                        <input type="number" id="premiumMeat" value="30">
                    </div>
                    <div class="input-group">
                        <label>ูุณุจุฉ ุงููุญูู ุงูุฌูุฏุฉ (%)</label>
                        <input type="number" id="goodMeat" value="50">
                    </div>
                    <div class="input-group">
                        <label>ูุณุจุฉ ุงููุญูู ุงูุนุงุฏูุฉ (%)</label>
                        <input type="number" id="regularMeat" value="20">
                    </div>
                </div>
                
                <div class="section">
                    <h3>ุชุญููู ุงูุทูุจ</h3>
                    <div class="input-group">
                        <label>ุนุฏุฏ ุงูุนููุงุก ุงููุชููุน (ุฃุถุงุญู)</label>
                        <input type="number" id="udheyaCustomers" value="100">
                    </div>
                    <div class="input-group">
                        <label>ูููุฉ ุงููุญู ุงููุทููุจุฉ ุดูุฑูุงู (ูููู)</label>
                        <input type="number" id="meatDemand" value="500">
                    </div>
                    <div class="input-group">
                        <label>ุนุฏุฏ ุงูุฎุฑุงู ุงูุญูุฉ ููุจูุน ุดูุฑูุงู</label>
                        <input type="number" id="liveAnimalMonthly" value="10">
                    </div>
                    <div class="input-group">
                        <label>ุนุฏุฏ ููุงุณุจุงุช ุงููุงุชุฑููุฌ ุดูุฑูุงู</label>
                        <input type="number" id="cateringEvents" value="4">
                    </div>
                    <div class="input-group">
                        <label>ูุชูุณุท ุนุฏุฏ ุงูุฃุดุฎุงุต/ููุงุณุจุฉ ูุงุชุฑููุฌ</label>
                        <input type="number" id="cateringPeople" value="50">
                    </div>
                    <div class="input-group">
                        <label>ุนุฏุฏ ุฅูุฌุงุฑุงุช ุงูููุงุณุจุงุช ุดูุฑูุงู</label>
                        <input type="number" id="eventRentals" value="3">
                    </div>
                    <div class="input-group">
                        <label>ุนุฏุฏ ุงูุฎุฑุงู ููุชุตุฏูุฑ ุดูุฑูุงู</label>
                        <input type="number" id="exportMonthly" value="5">
                    </div>
                    <div class="input-group">
                        <label>ุฅูุชุงุฌ ุงูุณูุงุฏ ุงูุนุถูู (ุทู/ุณูุฉ)</label>
                        <input type="number" id="manureProduction" value="20">
                    </div>
                </div>
                
                <div class="section">
                    <h3>ูุนุฏุงุช ุงููุงุชุฑููุฌ ูุงูููุงุณุจุงุช</h3>
                    <div class="input-group">
                        <label>ุดูุงูุงุช ููุนุฏุงุช ุทุจุฎ</label>
                        <input type="number" id="cateringCooking" value="30000">
                    </div>
                    <div class="input-group">
                        <label>ุฎูุงู ููุฑุงุณู ูุทุงููุงุช</label>
                        <input type="number" id="cateringFurniture" value="40000">
                    </div>
                    <div class="input-group">
                        <label>ุฃุทุจุงู ูุฃุฏูุงุช ุชูุฏูู</label>
                        <input type="number" id="cateringServing" value="15000">
                    </div>
                    <div class="input-group">
                        <label>ูููุฏ ููุฑุจุงุก ูุชููู</label>
                        <input type="number" id="generator" value="25000">
                    </div>
                    <div class="input-group">
                        <label>ุชุตููุฑ ุงุญุชุฑุงูู ููููุชุฌุงุช</label>
                        <input type="number" id="photography" value="5000">
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ุจูุงูุงุช ุงูุฃุบูุงู -->
        <div id="livestock" class="tab-content">
            <div class="grid">
                <div class="section">
                    <h3>ุดุฑุงุก ุงูุฃุบูุงู</h3>
                    <div class="grid-2">
                        <div class="input-group">
                            <label>ุนุฏุฏ ุงูุฃุบูุงู ุงููุจุฏุฆู</label>
                            <input type="number" id="initialSheep" value="50">
                        </div>
                        <div class="input-group">
                            <label>ุณุนุฑ ุงูุฎุฑูู (ุฌููู)</label>
                            <input type="number" id="sheepCost" value="3500">
                        </div>
                        <div class="input-group">
                            <label>ุนุฏุฏ ุงููุนุงุฌ</label>
                            <input type="number" id="ewes" value="30">
                        </div>
                        <div class="input-group">
                            <label>ุนุฏุฏ ุงููุจุงุด</label>
                            <input type="number" id="rams" value="3">
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <h3>ูุนุฏูุงุช ุงูุฅูุชุงุฌ</h3>
                    <div class="grid-2">
                        <div class="input-group">
                            <label>ูุนุฏู ุงูููุงุฏุฉ %</label>
                            <input type="number" id="birthRate" value="150">
                            <span class="small-text">150% = 1.5 ููููุฏ/ูุนุฌุฉ</span>
                        </div>
                        <div class="input-group">
                            <label>ูุนุฏู ุงููููู %</label>
                            <input type="number" id="mortalityRate" value="5">
                        </div>
                        <div class="input-group">
                            <label>ููุช ุงูุชุณููู (ุดูุฑ)</label>
                            <input type="number" id="timeToMarket" value="6">
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <h3>ุงูุชุบุฐูุฉ ูุงูููุงู</h3>
                    <div class="grid-2">
                        <div class="input-group">
                            <label>ุนูู ูุฌู/ููู</label>
                            <input type="number" id="feedPerDay" value="1.5" step="0.1">
                        </div>
                        <div class="input-group">
                            <label>ุณุนุฑ ุทู ุงูุนูู</label>
                            <input type="number" id="feedPriceTon" value="12000">
                        </div>
                        <div class="input-group">
                            <label>ูุนุฏู ุชุญููู</label>
                            <input type="number" id="feedConversion" value="5" step="0.1">
                            <span class="small-text">ูุฌู ุนูู/ูุฌู ุฒูุงุฏุฉ</span>
                        </div>
                        <div class="input-group">
                            <label>ููุงู ูุชุฑ/ููู</label>
                            <input type="number" id="waterPerDay" value="8">
                            <span class="small-text">ูุฒูุฏ ูู12 ูู ุงูุตูู</span>
                        </div>
                        <div class="input-group">
                            <label>ุณุนุฑ ูยณ ููุงู</label>
                            <input type="number" id="waterPrice" value="3.5" step="0.1">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ุงูุจููุฉ ุงูุชุญุชูุฉ -->
        <div id="infrastructure" class="tab-content">
            <div class="grid">
                <div class="section">
                    <h3>ุงูุฃุฑุถ ูุงููุจุงูู</h3>
                    <div class="grid-2">
                        <div class="input-group">
                            <label>ูุณุงุญุฉ (ูยฒ)</label>
                            <input type="number" id="landArea" value="2000">
                        </div>
                        <div class="input-group">
                            <label>ุฅูุฌุงุฑ ุณููู</label>
                            <input type="number" id="landRent" value="60000">
                            <span class="small-text">0 ุฅุฐุง ุชููู</span>
                        </div>
                        <div class="input-group">
                            <label>ุจูุงุก ุงูุญุธุงุฆุฑ</label>
                            <input type="number" id="shelterCost" value="150000">
                        </div>
                        <div class="input-group">
                            <label>ุงูุณูุงุฌ</label>
                            <input type="number" id="fencingCost" value="40000">
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <h3>ุงููุนุฏุงุช ูุงูุชุฌููุฒุงุช</h3>
                    <div class="grid-3">
                        <div class="input-group">
                            <label>ูุธุงู ุงูููุงู</label>
                            <input type="number" id="waterSystem" value="25000">
                        </div>
                        <div class="input-group">
                            <label>ุชุฏููุฑ ุงูููุงู</label>
                            <input type="number" id="waterRecycling" value="40000">
                            <span class="small-text">ูููุฑ 30%</span>
                        </div>
                        <div class="input-group">
                            <label>ูุนุฏุงุช ุงูุชุบุฐูุฉ</label>
                            <input type="number" id="feedingEquipment" value="15000">
                        </div>
                        <div class="input-group">
                            <label>ูุฎุฒู ุงูุนูู</label>
                            <input type="number" id="feedStorage" value="30000">
                        </div>
                        <div class="input-group">
                            <label>ุซูุงุฌุงุช ุญูุธ</label>
                            <input type="number" id="refrigerators" value="80000">
                        </div>
                        <div class="input-group">
                            <label>ูุฑูุฒุฑุงุช</label>
                            <input type="number" id="freezers" value="60000">
                        </div>
                        <div class="input-group">
                            <label>ูุนุฏุงุช ุชุบููู</label>
                            <input type="number" id="packagingEquipment" value="35000">
                        </div>
                        <div class="input-group">
                            <label>ูุธุงู ุจููุฌุงุฒ</label>
                            <input type="number" id="biogasSystem" value="75000">
                            <span class="small-text">ุงุฎุชูุงุฑู</span>
                        </div>
                        <div class="input-group">
                            <label>ูุนุฏุงุช ุฃุฎุฑู</label>
                            <input type="number" id="otherEquipment" value="20000">
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <h3>ุงููุฑูุจุงุช ูุงูููู</h3>
                    <div class="grid-2">
                        <div class="input-group">
                            <label>ุณูุงุฑุฉ ููู ุนุงุฏูุฉ</label>
                            <input type="number" id="vehicle" value="0">
                            <span class="small-text">0 ุฅุฐุง ููู ูุคุฌุฑ</span>
                        </div>
                        <div class="input-group">
                            <label>ุณูุงุฑุฉ ูุจุฑุฏุฉ</label>
                            <input type="number" id="refrigeratedVehicle" value="350000">
                        </div>
                        <div class="input-group">
                            <label>ููู ุดูุฑู</label>
                            <input type="number" id="transportMonthly" value="5000">
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <h3>ุงูุจูุน ุงูุฃูููุงูู ูุงูุชูููุฉ</h3>
                    <div class="grid-2">
                        <div class="input-group">
                            <label>ูููุน ุฅููุชุฑููู</label>
                            <input type="number" id="website" value="25000">
                        </div>
                        <div class="input-group">
                            <label>ุชุทุจูู ููุจุงูู</label>
                            <input type="number" id="mobileApp" value="50000">
                        </div>
                        <div class="input-group">
                            <label>ุจูุงุจุฉ ุฏูุน</label>
                            <input type="number" id="paymentGateway" value="10000">
                        </div>
                        <div class="input-group">
                            <label>ูุธุงู ุงููุฎุฒูู</label>
                            <input type="number" id="inventorySystem" value="15000">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ุงูุชุดุบูู -->
        <div id="operations" class="tab-content">
            <div class="grid">
                <div class="section">
                    <h3>ุงูุนูุงูุฉ</h3>
                    <div class="input-group">
                        <label>ุนุฏุฏ ุงูุนูุงู</label>
                        <input type="number" id="workers" value="2">
                    </div>
                    <div class="input-group">
                        <label>ุฑุงุชุจ ุงูุนุงูู ุงูุดูุฑู</label>
                        <input type="number" id="workerSalary" value="3000">
                    </div>
                    <div class="input-group">
                        <label>ูุดุฑู/ูุฏูุฑ (ุฑุงุชุจ ุดูุฑู)</label>
                        <input type="number" id="managerSalary" value="0">
                        <span class="small-text">0 ุฅุฐุง ููุช ุณุชุฏูุฑ ุจููุณู</span>
                    </div>
                </div>
                
                <div class="section">
                    <h3>ุงูุฎุฏูุงุช ุงูุจูุทุฑูุฉ</h3>
                    <div class="input-group">
                        <label>ุชูููุฉ ุงูุชุญุตููุงุช ุงูุณูููุฉ/ุฑุฃุณ</label>
                        <input type="number" id="vaccinesPerHead" value="150">
                    </div>
                    <div class="input-group">
                        <label>ููุฒุงููุฉ ุทูุงุฑุฆ ุจูุทุฑูุฉ ุดูุฑูุฉ</label>
                        <input type="number" id="vetEmergency" value="2500">
                    </div>
                    <div class="input-group">
                        <label>ูุญุต ุฏูุฑู ุดูุฑู</label>
                        <input type="number" id="vetCheckup" value="1500">
                    </div>
                </div>
                
                <div class="section">
                    <h3>ูุตุงุฑูู ุฃุฎุฑู</h3>
                    <div class="input-group">
                        <label>ุงูููุฑุจุงุก ูุงููุงุก ุดูุฑูุงู</label>
                        <input type="number" id="utilities" value="2000">
                    </div>
                    <div class="input-group">
                        <label>ุงูุชุณููู ูุงูุฅุนูุงู ุดูุฑูุงู</label>
                        <input type="number" id="marketing" value="3000">
                    </div>
                    <div class="input-group">
                        <label>ุฅุนูุงูุงุช ููุณุจูู ูุฅูุณุชุฌุฑุงู</label>
                        <input type="number" id="digitalMarketing" value="5000">
                    </div>
                    <div class="input-group">
                        <label>ุงูุชุฃููู ุงูุณููู</label>
                        <input type="number" id="insurance" value="12000">
                    </div>
                    <div class="input-group">
                        <label>ุฑุฎุต ูุชุตุงุฑูุญ ุณูููุฉ</label>
                        <input type="number" id="licenses" value="8000">
                    </div>
                    <div class="input-group">
                        <label>ุดูุงุฏุฉ ุงูุฐุจุญ ุงูุญูุงู</label>
                        <input type="number" id="halalCertificate" value="15000">
                    </div>
                    <div class="input-group">
                        <label>ุดูุงุฏุงุช ุงูุฌูุฏุฉ ูุงูุตุญุฉ</label>
                        <input type="number" id="qualityCertificates" value="10000">
                    </div>
                </div>
                
                <div class="section">
                    <h3>ุชูุงููู ุงูุฐุจุญ ูุงูุชุฌููุฒ</h3>
                    <div class="input-group">
                        <label>ุฑุณูู ุงููุฌุฒุฑ/ุฎุฑูู</label>
                        <input type="number" id="slaughterFee" value="100">
                    </div>
                    <div class="input-group">
                        <label>ุชูููุฉ ุงูุชูุทูุน ูุงูุชุบููู/ุฎุฑูู</label>
                        <input type="number" id="processingFee" value="150">
                    </div>
                    <div class="input-group">
                        <label>ุฃููุงุณ ุชูุฑูุบ ูุชุนุจุฆุฉ ุดูุฑูุงู</label>
                        <input type="number" id="packagingMonthly" value="2000">
                    </div>
                    <div class="input-group">
                        <label>ุนูุงูุฉ ูุคูุชุฉ ูููุงุชุฑููุฌ/ููุงุณุจุฉ</label>
                        <input type="number" id="cateringStaffPerEvent" value="1500">
                    </div>
                    <div class="input-group">
                        <label>ุชูููุฉ ุงูุชูุตูู ุดูุฑูุงู</label>
                        <input type="number" id="deliveryCost" value="3000">
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ุจุฑูุงูุฌ ุงูุชุฑุจูุฉ -->
        <div id="breeding" class="tab-content">
            <div class="info-box">
                ๐ ุญุฏุฏ ุจุฑูุงูุฌ ุงูุชุฑุจูุฉ ูุงูุชูุงุณู ูุชุญุณูู ุงูุฅูุชุงุฌูุฉ
            </div>
            
            <div class="grid">
                <div class="section">
                    <h3>ูุนุฏูุงุช ุงูุชูุงุณู</h3>
                    <div class="grid-2">
                        <div class="input-group">
                            <label>ูุนุฏู ุงูุฎุตูุจุฉ %</label>
                            <input type="number" id="fertilityRate" value="85">
                        </div>
                        <div class="input-group">
                            <label>ููุงุฏุงุช/ุณูุฉ</label>
                            <input type="number" id="birthsPerYear" value="1.5" step="0.1">
                            <span class="small-text">3 ููุงุฏุงุช/ุณูุชูู</span>
                        </div>
                        <div class="input-group">
                            <label>ููุงููุฏ/ููุงุฏุฉ</label>
                            <input type="number" id="lambsPerBirth" value="1.3" step="0.1">
                        </div>
                        <div class="input-group">
                            <label>ูุณุจุฉ ุชูุงุฆู %</label>
                            <input type="number" id="twinRate" value="30">
                        </div>
                        <div class="input-group">
                            <label>ุนูุฑ ุฃูู ููุงุฏุฉ</label>
                            <input type="number" id="firstBirthAge" value="18">
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <h3>ุจุฑูุงูุฌ ุงูุชูููุญ</h3>
                    <div class="grid-2">
                        <div class="input-group">
                            <label>ููุน ุงูุชูููุญ</label>
                            <select id="inseminationType">
                                <option value="natural">ุทุจูุนู</option>
                                <option value="artificial">ุตูุงุนู</option>
                                <option value="mixed">ูุฎุชูุท</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label>ุชูููุฉ ุตูุงุนู/ูุนุฌุฉ</label>
                            <input type="number" id="artificialInseminationCost" value="200">
                        </div>
                        <div class="input-group">
                            <label>ูุฌุงุญ ุงูุชูููุญ %</label>
                            <input type="number" id="inseminationSuccess" value="75">
                        </div>
                        <div class="input-group">
                            <label>ูุจุงุด ูุทููุจุฉ</label>
                            <input type="number" id="ramsNeeded" value="3" readonly>
                            <span class="small-text">ูุจุด/25 ูุนุฌุฉ</span>
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <h3>ุฌุฏูู ุงูุชุฑุจูุฉ</h3>
                    <div class="grid-2">
                        <div class="input-group">
                            <label>ููุณู ุงูุชูููุญ</label>
                            <select id="mainBreedingSeason">
                                <option value="spring">ุงูุฑุจูุน (ูุงุฑุณ-ูุงูู)</option>
                                <option value="fall">ุงูุฎุฑูู (ุณุจุชูุจุฑ-ููููุจุฑ)</option>
                                <option value="both">ููุณููู</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label>ูุชุฑุฉ ุงูุญูู</label>
                            <input type="number" id="gestationPeriod" value="150" readonly>
                        </div>
                        <div class="input-group">
                            <label>ูุชุฑุฉ ุงูุฑุถุงุนุฉ</label>
                            <input type="number" id="lactationPeriod" value="90">
                        </div>
                        <div class="input-group">
                            <label>ุนูุฑ ุงููุทุงู</label>
                            <input type="number" id="weaningAge" value="90">
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <h3>ุชุญุณูู ุงูุณูุงูุฉ</h3>
                    <div class="grid-2">
                        <div class="input-group">
                            <label>ุจุฑูุงูุฌ ุชุญุณูู</label>
                            <select id="geneticImprovement">
                                <option value="none">ูุง ููุฌุฏ</option>
                                <option value="local">ูุญูู</option>
                                <option value="import">ุงุณุชูุฑุงุฏ</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label>ุชูููุฉ ูุจุด ูุญุณู</label>
                            <input type="number" id="improvedRamCost" value="25000">
                        </div>
                        <div class="input-group">
                            <label>ุนุฏุฏ ูุจุงุด ูุญุณูุฉ</label>
                            <input type="number" id="improvedRamsCount" value="1">
                        </div>
                        <div class="input-group">
                            <label>ุฒูุงุฏุฉ ุฅูุชุงุฌูุฉ %</label>
                            <input type="number" id="productivityIncrease" value="20">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ุงููุฎุงุทุฑ ูุงูุถุฑุงุฆุจ -->
        <div id="risks" class="tab-content">
            <div class="info-box">
                โ๏ธ ุชูููู ุงููุฎุงุทุฑ ูุงูุงูุชุฒุงูุงุช ุงููุงููุฉ ูููุดุฑูุน
            </div>
            
            <div class="grid">
                <div class="section">
                    <h3>ุฅุฏุงุฑุฉ ุงููุฎุงุทุฑ</h3>
                    <div class="grid-2">
                        <div class="input-group">
                            <label>ุงุญุชูุงุทู ุตุญู %</label>
                            <input type="number" id="healthEmergency" value="10">
                            <span class="small-text">ูู ูููุฉ ุงููุทูุน</span>
                        </div>
                        <div class="input-group">
                            <label>ูููู ุญุฑุงุฑุฉ %</label>
                            <input type="number" id="heatWaveMortality" value="3">
                        </div>
                        <div class="input-group">
                            <label>ุชููุจ ุฃุนูุงู %</label>
                            <input type="number" id="feedPriceVolatility" value="15">
                        </div>
                        <div class="input-group">
                            <label>ุชููู ุชูุฑูุฏ ููู</label>
                            <input type="number" id="supplyInterruption" value="10">
                        </div>
                        <div class="input-group">
                            <label>ูุธุงู ุชุจุฑูุฏ</label>
                            <input type="number" id="coolingSystems" value="30000">
                        </div>
                        <div class="input-group">
                            <label>ุชุฃููู ููุงุฑุซ</label>
                            <input type="number" id="naturalDisasterInsurance" value="15000">
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <h3>ุงูุถุฑุงุฆุจ ูุงูุฑุณูู</h3>
                    <div class="grid-3">
                        <div class="input-group">
                            <label>ุถุฑูุจุฉ ุฏุฎู %</label>
                            <input type="number" id="incomeTax" value="22.5">
                        </div>
                        <div class="input-group">
                            <label>ูููุฉ ูุถุงูุฉ %</label>
                            <input type="number" id="vat" value="14">
                        </div>
                        <div class="input-group">
                            <label>ุฑุณูู ุจูุฏูุฉ</label>
                            <input type="number" id="municipalFees" value="5000">
                        </div>
                        <div class="input-group">
                            <label>ุบุฑูุฉ ุชุฌุงุฑุฉ</label>
                            <input type="number" id="chamberFees" value="2000">
                        </div>
                        <div class="input-group">
                            <label>ุงุชุญุงุฏ ููุชุฌูู</label>
                            <input type="number" id="producerUnionFees" value="3000">
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <h3>ุงูุฒูุงุฉ</h3>
                    <div class="grid-3">
                        <div class="input-group">
                            <label>ูุตุงุจ ุงูุบูู</label>
                            <input type="number" id="zakatNisab" value="40" readonly>
                        </div>
                        <div class="input-group">
                            <label>ุฒูุงุฉ ูุณุชุญูุฉ</label>
                            <input type="number" id="zakatDue" value="0" readonly>
                            <span class="small-text">ุชุญุณุจ ุชููุงุฆูุงู</span>
                        </div>
                        <div class="input-group">
                            <label>ูููุฉ ุจุงูุฌููู</label>
                            <input type="number" id="zakatValue" value="0" readonly>
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <h3>ุงูุชุตุฏูุฑ ูุงูุฌูุฏุฉ</h3>
                    <div class="grid-2">
                        <div class="input-group">
                            <label>ุดูุงุฏุงุช ุชุตุฏูุฑ</label>
                            <input type="number" id="exportCertificates" value="25000">
                        </div>
                        <div class="input-group">
                            <label>ุดุญู/ุฎุฑูู</label>
                            <input type="number" id="shippingPerHead" value="500">
                        </div>
                        <div class="input-group">
                            <label>ISO 22000</label>
                            <input type="number" id="isoCertificate" value="50000">
                        </div>
                        <div class="input-group">
                            <label>ููุตุงุช ุฃูููุงูู</label>
                            <input type="number" id="onlinePlatformFees" value="24000">
                            <span class="small-text">ุฃูุงุฒููุ ุฌูููุง</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ุงูุชุญููู ุงูููุณูู -->
        <div id="seasonal" class="tab-content">
            <div class="info-box">
                ๐ ุญุฏุฏ ุชูุฒูุน ุงููุจูุนุงุช ุงููุชููุน ุนูู ูุฏุงุฑ ุงูุณูุฉ ูุญุณุงุจ ุงุญุชูุงุฌุงุช ุงูุณูููุฉ
            </div>
            
            <div class="grid-3">
                <div class="section-compact">
                    <h3>ุชูุฒูุน ุงูุฃุถุงุญู</h3>
                    <div class="grid-2" style="gap: 4px;">
                        <div class="compact-input">
                            <label>ุฐู ุงูุญุฌุฉ %</label>
                            <input type="number" id="eidSales" value="85">
                            <span class="small-text">ุงููุณุจุฉ ุงูุฃูุจุฑ</span>
                        </div>
                        <div class="compact-input">
                            <label>ุจุงูู ุงูุณูุฉ %</label>
                            <input type="number" id="nonEidSales" value="15" readonly>
                        </div>
                    </div>
                </div>
                
                <div class="section-compact">
                    <h3>ุงูููุงุณู</h3>
                    <div class="compact-grid">
                        <div class="compact-input">
                            <label>ุฑูุถุงู+</label>
                            <input type="number" id="ramadanIncrease" value="30">
                        </div>
                        <div class="compact-input">
                            <label>ุตูู+</label>
                            <input type="number" id="summerCatering" value="40">
                            <span class="small-text" style="font-size: 0.6rem;">ููุณู ุงูุฃูุฑุงุญ</span>
                        </div>
                        <div class="compact-input">
                            <label>ุดุชุงุก-</label>
                            <input type="number" id="winterDecrease" value="20">
                        </div>
                    </div>
                </div>
                
                <div class="section-compact">
                    <h3>ุงูุณูููุฉ</h3>
                    <div style="font-size: 0.8rem; line-height: 1.4;">
                        <div style="margin-bottom: 5px;">
                            <strong>ุฃุนูู ุงุญุชูุงุฌ:</strong> ุดูุฑ <span id="highestCashNeed">0</span>
                        </div>
                        <div style="margin-bottom: 5px;">
                            <strong>ุฃูู ุฅูุฑุงุฏ:</strong> <span id="lowestRevenue">0</span>
                        </div>
                        <div style="margin-bottom: 5px;">
                            <strong>ุฃุนูู ุฅูุฑุงุฏ:</strong> <span id="highestRevenue">0</span>
                        </div>
                        <div style="background: #e8f4f8; padding: 5px; border-radius: 3px; margin-top: 6px;">
                            <strong>ุงุญุชูุงุทู ูุทููุจ:</strong> <span id="cashReserve" style="color: #2c3e50;">0</span> ุฌููู
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ุงูุชุญููู ุงููุงูู -->
        <div id="financial" class="tab-content">
            <!-- Visual Analytics Charts -->
            <div class="chart-section">
                <h3>๐ ุงูุฑุณูู ุงูุจูุงููุฉ ุงูุชุญููููุฉ</h3>
                <div class="grid-2">
                    <div class="chart-container">
                        <canvas id="cashFlowChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="revenueChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="breakEvenChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="costBreakdownChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="summary-section">
                <h2>๐ ุงูููุฎุต ุงููุงูู ุงูุดุงูู</h2>
                
                <div class="metrics-grid">
                    <div class="metric">
                        <div class="metric-label">ุงูุงุณุชุซูุงุฑ ุงููุทููุจ</div>
                        <div class="metric-value"><span id="totalInvestment">0</span> ุฌููู</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">ุฅูุฑุงุฏุงุช ุงูุณูุฉ 1</div>
                        <div class="metric-value"><span id="yearOneRevenue">0</span> ุฌููู</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">ุชูุงููู ุงูุณูุฉ 1</div>
                        <div class="metric-value"><span id="yearOneCosts">0</span> ุฌููู</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">ุตุงูู ุงูุฑุจุญ</div>
                        <div class="metric-value"><span id="yearOneProfit">0</span> ุฌููู</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">ููุทุฉ ุงูุชุนุงุฏู</div>
                        <div class="metric-value"><span id="breakEven">0</span> ุดูุฑ</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">ุงูุนุงุฆุฏ ROI</div>
                        <div class="metric-value"><span id="roi">0</span>%</div>
                    </div>
                </div>
                
                <div id="decisionBox" class="decision-box">
                    ุฌุงุฑู ุงูุญุณุงุจ...
                </div>
                
                <div style="margin-top: 10px; background: rgba(255,255,255,0.1); padding: 10px; border-radius: 6px;">
                    <h3 style="color: white; margin-bottom: 6px; font-size: 0.9rem;">ุชูุงุตูู ุงูุชุญููู:</h3>
                    
                    <div class="grid-3" style="color: white; font-size: 0.75rem; line-height: 1.3; gap: 10px;">
                        <div style="background: rgba(0,0,0,0.2); padding: 6px; border-radius: 4px;">
                            <strong style="display: block; margin-bottom: 4px; color: #ffd700;">๐ฐ ุงูุงุณุชุซูุงุฑ</strong>
                            <div>ุงูุจููุฉ: <span id="infraTotal">0</span></div>
                            <div>ุงููุทูุน: <span id="flockTotal">0</span></div>
                            <div>ุฑุฃุณ ูุงู: <span id="workingCapital">0</span></div>
                            <div>ุฃูููุงูู: <span id="onlineTotal">0</span></div>
                        </div>
                        
                        <div style="background: rgba(0,0,0,0.2); padding: 6px; border-radius: 4px;">
                            <strong style="display: block; margin-bottom: 4px; color: #ffd700;">๐ ุดูุฑูุงู</strong>
                            <div>ุชุดุบูู: <span id="monthlyOperating">0</span></div>
                            <div>ุฐุจุญ: <span id="processingCosts">0</span></div>
                            <div>ุชุณููู: <span id="digitalMarketingCost">0</span></div>
                            <div>ููุงู: <span id="waterCostDisplay">0</span></div>
                        </div>
                        
                        <div style="background: rgba(0,0,0,0.2); padding: 6px; border-radius: 4px;">
                            <strong style="display: block; margin-bottom: 4px; color: #ffd700;">๐ต ุฅูุฑุงุฏุงุช</strong>
                            <div>ุฃุถุงุญู: <span id="udheyaRevenue">0</span></div>
                            <div>ูุญูู: <span id="meatRevenue">0</span></div>
                            <div>ุญูุฉ: <span id="liveAnimalRevenue">0</span></div>
                            <div>ูุงุชุฑููุฌ: <span id="cateringRevenue">0</span></div>
                        </div>
                        
                        <div style="background: rgba(0,0,0,0.2); padding: 6px; border-radius: 4px;">
                            <strong style="display: block; margin-bottom: 4px; color: #ffd700;">โ ุฅุถุงููุฉ</strong>
                            <div>ุชุฃุฌูุฑ: <span id="eventRentalRevenue">0</span></div>
                            <div>ุชุตุฏูุฑ: <span id="exportRevenue">0</span></div>
                            <div>ุณูุงุฏ: <span id="manureRevenue">0</span></div>
                            <div>ุฌููุฏ: <span id="hideRevenue">0</span></div>
                        </div>
                        
                        <div style="background: rgba(0,0,0,0.2); padding: 6px; border-radius: 4px;">
                            <strong style="display: block; margin-bottom: 4px; color: #ffd700;">๐ ูุคุดุฑุงุช</strong>
                            <div>ูุงูุด: <span id="profitMargin">0</span>%</div>
                            <div>ุงุณุชุฑุฏุงุฏ: <span id="paybackPeriod">0</span>ู</div>
                            <div>ุณูููุฉ: <span id="requiredCashReserve">0</span></div>
                        </div>
                        
                        <div style="background: rgba(0,0,0,0.2); padding: 6px; border-radius: 4px;">
                            <strong style="display: block; margin-bottom: 4px; color: #ffd700;">โ๏ธ ุงูุชุฒุงูุงุช</strong>
                            <div>ุฒูุงุฉ: <span id="zakatDisplay">0</span></div>
                            <div>ุถุฑูุจุฉ: <span id="taxDisplay">0</span></div>
                            <div>ูุฎุงุทุฑ: <span id="riskReserveDisplay">0</span></div>
                        </div>
                    </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Multi-Year Planning -->
        <div id="multiyear" class="tab-content">
            <div class="info-box">
                ๐ ุงูุชุฎุทูุท ุงูุงุณุชุฑุงุชูุฌู ูููุดุฑูุน ุนูู ูุฏุงุฑ 5 ุณููุงุช ูุน ููู ุงููุทูุน ูุงูุงุณุชุซูุงุฑุงุช
            </div>
            
            <div class="grid">
                <div class="section">
                    <h3>ูุนุฏูุงุช ุงูููู ุงููุชููุนุฉ</h3>
                    <div class="grid-2">
                        <div class="input-group">
                            <label>ููู ุงููุทูุน ุงูุณููู %</label>
                            <input type="number" id="flockGrowthRate" value="25">
                            <span class="small-text">ูู ุฎูุงู ุงูููุงููุฏ ูุงูุดุฑุงุก</span>
                        </div>
                        <div class="input-group">
                            <label>ุชุญุณู ุงูุฅูุชุงุฌูุฉ %</label>
                            <input type="number" id="productivityImprovement" value="5">
                            <span class="small-text">ุณูููุงู</span>
                        </div>
                        <div class="input-group">
                            <label>ุฒูุงุฏุฉ ุงูุฃุณุนุงุฑ %</label>
                            <input type="number" id="priceInflation" value="8">
                        </div>
                        <div class="input-group">
                            <label>ุฒูุงุฏุฉ ุงูุชูุงููู %</label>
                            <input type="number" id="costInflation" value="6">
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <h3>ุฎุทุฉ ุงูุชูุณุนุงุช</h3>
                    <div class="grid-3">
                        <div class="input-group">
                            <label>ุชูุณุนุฉ ุงูุณูุฉ 2</label>
                            <input type="number" id="expansion2" value="100000">
                            <span class="small-text">ุญุธุงุฆุฑ ุฅุถุงููุฉ</span>
                        </div>
                        <div class="input-group">
                            <label>ุชูุณุนุฉ ุงูุณูุฉ 3</label>
                            <input type="number" id="expansion3" value="150000">
                            <span class="small-text">ูุนุฏุงุช ุชุตููุน</span>
                        </div>
                        <div class="input-group">
                            <label>ุชูุณุนุฉ ุงูุณูุฉ 5</label>
                            <input type="number" id="expansion5" value="200000">
                            <span class="small-text">ูุฑุน ุฌุฏูุฏ</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 5-Year Projections Table -->
            <div class="chart-section">
                <h3>๐ ุงูุฅุณูุงุทุงุช ุงููุงููุฉ ูู 5 ุณููุงุช</h3>
                <table id="fiveYearTable" style="width: 100%; border-collapse: collapse; margin: 10px 0;">
                    <thead style="background: #3498db; color: white;">
                        <tr>
                            <th style="padding: 8px; border: 1px solid #ddd;">ุงูุจูุงู</th>
                            <th style="padding: 8px; border: 1px solid #ddd;">ุงูุณูุฉ 1</th>
                            <th style="padding: 8px; border: 1px solid #ddd;">ุงูุณูุฉ 2</th>
                            <th style="padding: 8px; border: 1px solid #ddd;">ุงูุณูุฉ 3</th>
                            <th style="padding: 8px; border: 1px solid #ddd;">ุงูุณูุฉ 4</th>
                            <th style="padding: 8px; border: 1px solid #ddd;">ุงูุณูุฉ 5</th>
                        </tr>
                    </thead>
                    <tbody id="fiveYearTableBody">
                        <!-- Will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
            
            <!-- Multi-Year Charts -->
            <div class="chart-section">
                <h3>๐ ุงูุฑุณูู ุงูุจูุงููุฉ ูุชุนุฏุฏุฉ ุงูุณููุงุช</h3>
                <div class="grid-2">
                    <div class="chart-container">
                        <canvas id="multiYearRevenueChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="flockGrowthChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Feed Optimizer -->
        <div id="feedOptimizer" class="tab-content">
            <div class="info-box">
                ๐พ ูุญุณู ุงูุฃุนูุงู - ุงุญุณุจ ุงูุชุฑููุจุฉ ุงููุซูู ููุนูู ูุชุญููู ุฃูุถู ูุณุจุฉ ุชูููุฉ/ุชุบุฐูุฉ
            </div>
            
            <div class="grid">
                <div class="section">
                    <h3>ููููุงุช ุงูุนูู ุงููุชุงุญุฉ</h3>
                    <div class="grid-3">
                        <div class="input-group">
                            <label>ุฐุฑุฉ - ุณุนุฑ/ุทู</label>
                            <input type="number" id="cornPrice" value="8000">
                            <span class="small-text">ุทุงูุฉ: 3.2 ููุฌุง ูุงููุฑู</span>
                        </div>
                        <div class="input-group">
                            <label>ูุณุจ ููู ุตููุง - ุณุนุฑ/ุทู</label>
                            <input type="number" id="soybeanPrice" value="15000">
                            <span class="small-text">ุจุฑูุชูู: 44%</span>
                        </div>
                        <div class="input-group">
                            <label>ูุฎุงูุฉ ููุญ - ุณุนุฑ/ุทู</label>
                            <input type="number" id="wheatBranPrice" value="6000">
                            <span class="small-text">ุฃููุงู: 12%</span>
                        </div>
                        <div class="input-group">
                            <label>ุดุนูุฑ - ุณุนุฑ/ุทู</label>
                            <input type="number" id="barleyPrice" value="7000">
                            <span class="small-text">ุทุงูุฉ: 2.8 ููุฌุง ูุงููุฑู</span>
                        </div>
                        <div class="input-group">
                            <label>ุนูู ูุฑูุฒ - ุณุนุฑ/ุทู</label>
                            <input type="number" id="concentratePrice" value="12000">
                            <span class="small-text">ูุชูุงุฒู</span>
                        </div>
                        <div class="input-group">
                            <label>ุฏุฑูุณ ุจุฑุณูู - ุณุนุฑ/ุทู</label>
                            <input type="number" id="alfalfaPrice" value="4000">
                            <span class="small-text">ุฃููุงู ุนุงููุฉ</span>
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <h3>ุงููุชุทูุจุงุช ุงูุบุฐุงุฆูุฉ</h3>
                    <div class="grid-2">
                        <div class="input-group">
                            <label>ุงูุจุฑูุชูู ุงููุทููุจ %</label>
                            <input type="number" id="requiredProtein" value="16" step="0.1">
                        </div>
                        <div class="input-group">
                            <label>ุงูุทุงูุฉ ุงููุทููุจุฉ (ููุฌุง ูุงููุฑู/ูุฌู)</label>
                            <input type="number" id="requiredEnergy" value="2.8" step="0.1">
                        </div>
                        <div class="input-group">
                            <label>ุงูุฃููุงู ุงููุตูู %</label>
                            <input type="number" id="maxFiber" value="18">
                        </div>
                        <div class="input-group">
                            <label>ูููุฉ ุงูุนูู ุงูููููุฉ (ูุฌู)</label>
                            <input type="number" id="dailyFeedAmount" value="1.5" step="0.1">
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Optimized Feed Formula -->
            <div class="chart-section">
                <h3>๐ฏ ุงูุชุฑููุจุฉ ุงููุซูู ููุนูู</h3>
                <div class="grid-2">
                    <div>
                        <h4>ุงููุณุจ ุงููุซูู:</h4>
                        <div id="optimalFormula" style="background: #f8f9fa; padding: 10px; border-radius: 5px; margin: 10px 0;">
                            <!-- Will be populated by JavaScript -->
                        </div>
                        <div class="result">
                            ุชูููุฉ ุงูุทู: <span id="optimalCost">0</span> ุฌููู
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="feedCompositionChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Breeding Calendar -->
        <div id="breedingCalendar" class="tab-content">
            <div class="info-box">
                ๐ ุชูููู ุงูุชุฑุจูุฉ ูุชุชุจุน ููุงุนูุฏ ุงูุชูููุญ ูุงูููุงุฏุฉ ูุงููุทุงู
            </div>
            
            <div class="grid">
                <div class="section">
                    <h3>ุจุฑูุงูุฌ ุงูุชูููุญ ุงูุณููู</h3>
                    <div class="grid-2">
                        <div class="input-group">
                            <label>ุจุฏุงูุฉ ููุณู ุงูุชูููุญ ุงูุฃูู</label>
                            <input type="date" id="breeding1Start" value="2024-09-01">
                        </div>
                        <div class="input-group">
                            <label>ุจุฏุงูุฉ ููุณู ุงูุชูููุญ ุงูุซุงูู</label>
                            <input type="date" id="breeding2Start" value="2025-03-01">
                        </div>
                        <div class="input-group">
                            <label>ูุฏุฉ ุงูุชูููุญ (ููู)</label>
                            <input type="number" id="breedingDuration" value="45">
                        </div>
                        <div class="input-group">
                            <label>ูุชุฑุฉ ุงูุญูู (ููู)</label>
                            <input type="number" id="gestationDays" value="150" readonly>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Breeding Calendar Display -->
            <div class="chart-section">
                <h3>๐ ุชูููู ุงูุฃุญุฏุงุซ ุงููููุฉ</h3>
                <div id="breedingSchedule" style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 10px 0;">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
            
            <!-- Production Timeline Chart -->
            <div class="chart-section">
                <h3>๐ ุฎุท ุฒููู ููุฅูุชุงุฌ</h3>
                <div class="chart-container">
                    <canvas id="productionTimelineChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- Sensitivity Analysis -->
        <div id="sensitivity" class="tab-content">
            <div class="info-box">
                ๐ ุชุญููู ุงูุญุณุงุณูุฉ - ุงุนุฑู ููู ุชุคุซุฑ ุงูุชุบููุฑุงุช ูู ุงููุชุบูุฑุงุช ุงูุฑุฆูุณูุฉ ุนูู ุฑุจุญูุฉ ุงููุดุฑูุน
            </div>
            
            <div class="grid">
                <div class="section">
                    <h3>ูุทุงู ุงูุชุญููู</h3>
                    <div class="grid-3">
                        <div class="input-group">
                            <label>ุชุบููุฑ ุฃุณุนุงุฑ ุงูุจูุน (%)</label>
                            <input type="number" id="priceVariation" value="20" step="5">
                        </div>
                        <div class="input-group">
                            <label>ุชุบููุฑ ุชูุงููู ุงูุนูู (%)</label>
                            <input type="number" id="feedCostVariation" value="25" step="5">
                        </div>
                        <div class="input-group">
                            <label>ุชุบููุฑ ูุนุฏู ุงูููุงุฏุฉ (%)</label>
                            <input type="number" id="birthRateVariation" value="15" step="5">
                        </div>
                        <div class="input-group">
                            <label>ุชุบููุฑ ูุนุฏู ุงููููู (%)</label>
                            <input type="number" id="mortalityVariation" value="10" step="2">
                        </div>
                        <div class="input-group">
                            <label>ุชุบููุฑ ุงูุทูุจ ุนูู ุงูููุชุฌ (%)</label>
                            <input type="number" id="demandVariation" value="30" step="5">
                        </div>
                        <div class="input-group">
                            <label>ุนุฏุฏ ูุญุงูุงุฉ ูููุช ูุงุฑูู</label>
                            <input type="number" id="monteCarloRuns" value="1000" step="100">
                        </div>
                    </div>
                    <button onclick="runSensitivityAnalysis()" style="padding: 8px 20px; background: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer; margin-top: 10px;">
                        ุชุดุบูู ุงูุชุญููู
                    </button>
                </div>
            </div>
            
            <!-- Sensitivity Results -->
            <div class="chart-section">
                <h3>๐ ูุชุงุฆุฌ ุชุญููู ุงูุญุณุงุณูุฉ</h3>
                <div class="grid-2">
                    <div class="chart-container">
                        <canvas id="sensitivityChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="monteCarloChart"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- Risk Assessment -->
            <div class="chart-section">
                <h3>โ๏ธ ุชูููู ุงููุฎุงุทุฑ</h3>
                <div id="riskAssessment" style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 10px 0;">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
        </div>
        
        <!-- Market Intelligence -->
        <div id="marketIntel" class="tab-content">
            <div class="info-box">
                ๐ ุฐูุงุก ุงูุณูู - ุชุญููู ุงุชุฌุงูุงุช ุงูุฃุณุนุงุฑ ูุงูููุงูุณูู ูุชููุน ุงูุทูุจ
            </div>
            
            <div class="grid">
                <div class="section">
                    <h3>ุจูุงูุงุช ุงูุฃุณุนุงุฑ ุงูุชุงุฑูุฎูุฉ</h3>
                    <div class="grid-3">
                        <div class="input-group">
                            <label>ูุชูุณุท ุณุนุฑ ุงูุฃุถุญูุฉ 2023</label>
                            <input type="number" id="price2023" value="7500">
                        </div>
                        <div class="input-group">
                            <label>ูุชูุณุท ุณุนุฑ ุงูุฃุถุญูุฉ 2022</label>
                            <input type="number" id="price2022" value="7000">
                        </div>
                        <div class="input-group">
                            <label>ูุชูุณุท ุณุนุฑ ุงูุฃุถุญูุฉ 2021</label>
                            <input type="number" id="price2021" value="6500">
                        </div>
                        <div class="input-group">
                            <label>ุฒูุงุฏุฉ ุฑูุถุงู %</label>
                            <input type="number" id="ramadanPriceIncrease" value="15">
                        </div>
                        <div class="input-group">
                            <label>ุฒูุงุฏุฉ ุงูุญุฌ %</label>
                            <input type="number" id="hajjPriceIncrease" value="25">
                        </div>
                        <div class="input-group">
                            <label>ุงูุฎูุงุถ ุงูุตูู %</label>
                            <input type="number" id="summerPriceDecrease" value="10">
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <h3>ุชุญููู ุงูููุงูุณูู</h3>
                    <div class="grid-2">
                        <div class="input-group">
                            <label>ุนุฏุฏ ุงููุฒุงุฑุน ูู ุงูููุทูุฉ</label>
                            <input type="number" id="competitorCount" value="8">
                        </div>
                        <div class="input-group">
                            <label>ูุชูุณุท ุญุฌู ูุทูุน ุงูููุงูุณ</label>
                            <input type="number" id="competitorFlockSize" value="40">
                        </div>
                        <div class="input-group">
                            <label>ุญุตุชูุง ุงููุชููุนุฉ ูู ุงูุณูู %</label>
                            <input type="number" id="marketShare" value="12">
                        </div>
                        <div class="input-group">
                            <label>ููุฒุชูุง ุงูุชูุงูุณูุฉ</label>
                            <select id="competitiveAdvantage">
                                <option value="price">ุงูุณุนุฑ</option>
                                <option value="quality">ุงูุฌูุฏุฉ</option>
                                <option value="service">ุงูุฎุฏูุฉ</option>
                                <option value="location">ุงููููุน</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <h3>ุชููุน ุงูุทูุจ</h3>
                    <div class="grid-2">
                        <div class="input-group">
                            <label>ุนุฏุฏ ุงูุนุงุฆูุงุช ูู ุงูููุทูุฉ</label>
                            <input type="number" id="totalFamilies" value="5000">
                        </div>
                        <div class="input-group">
                            <label>ูุณุจุฉ ูู ูุถุญู %</label>
                            <input type="number" id="sacrificePercentage" value="70">
                        </div>
                        <div class="input-group">
                            <label>ููู ุนุฏุฏ ุงูุณูุงู ุณูููุงู %</label>
                            <input type="number" id="populationGrowth" value="2.5">
                        </div>
                        <div class="input-group">
                            <label>ุฒูุงุฏุฉ ุงูููุฉ ุงูุดุฑุงุฆูุฉ %</label>
                            <input type="number" id="purchasingPowerGrowth" value="5">
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Price Trends Chart -->
            <div class="chart-section">
                <h3>๐ ุงุชุฌุงูุงุช ุงูุฃุณุนุงุฑ ูุชููุนุงุช ุงูุทูุจ</h3>
                <div class="grid-2">
                    <div class="chart-container">
                        <canvas id="priceTrendsChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="demandForecastChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Compliance & Certification -->
        <div id="compliance" class="tab-content">
            <div class="info-box">
                ๐ ูุชุชุจุน ุงูุงูุชุฒุงูุงุช - ุชุฃูุฏ ูู ุงุณุชููุงุก ุฌููุน ุงููุชุทูุจุงุช ุงููุงููููุฉ ูุงูุดูุงุฏุงุช
            </div>
            
            <div class="grid">
                <div class="section">
                    <h3>ุงููุซุงุฆู ุงูุฃุณุงุณูุฉ</h3>
                    <div id="basicDocuments" class="compact-grid">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
                
                <div class="section">
                    <h3>ุดูุงุฏุงุช ุงูุฌูุฏุฉ ูุงูุตุญุฉ</h3>
                    <div id="qualityDocuments" class="compact-grid">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
                
                <div class="section">
                    <h3>ูุชุทูุจุงุช ุงูุชุตุฏูุฑ</h3>
                    <div id="exportDocuments" class="compact-grid">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>
            
            <!-- Compliance Progress -->
            <div class="chart-section">
                <h3>๐ ุญุงูุฉ ุงูุงูุชุฒุงู</h3>
                <div class="grid-2">
                    <div class="chart-container">
                        <canvas id="complianceChart"></canvas>
                    </div>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                        <h4>ููุฎุต ุงูุงูุชุฒุงู:</h4>
                        <div id="complianceSummary">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Operational Tools -->
        <div id="operations" class="tab-content">
            <div class="info-box">
                ๐๏ธ ุฃุฏูุงุช ุชุดุบูููุฉ - ูุญุงูู ุงูุฃูุฑุงุถุ ุฌุฏููุฉ ุงูุนูุงูุฉุ ูุญูู ุงูุนููุงุช
            </div>
            
            <div class="grid">
                <div class="section">
                    <h3>ูุญุงูู ุชูุดู ุงูุฃูุฑุงุถ</h3>
                    <div class="grid-2">
                        <div class="input-group">
                            <label>ููุน ุงููุฑุถ</label>
                            <select id="diseaseType">
                                <option value="ppr">ุทุงุนูู ุงููุฌุชุฑุงุช ุงูุตุบูุฑุฉ</option>
                                <option value="fmd">ุงูุญูู ุงูููุงุนูุฉ</option>
                                <option value="parasites">ุงูุทููููุงุช</option>
                                <option value="respiratory">ุฃูุฑุงุถ ุชููุณูุฉ</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label>ูุณุจุฉ ุงูุฅุตุงุจุฉ ุงููุชููุนุฉ %</label>
                            <input type="number" id="infectionRate" value="30">
                        </div>
                        <div class="input-group">
                            <label>ูุณุจุฉ ุงููููู %</label>
                            <input type="number" id="diseaseMortality" value="15">
                        </div>
                        <div class="input-group">
                            <label>ูุชุฑุฉ ุงูุนูุงุฌ (ููู)</label>
                            <input type="number" id="treatmentDuration" value="14">
                        </div>
                        <div class="input-group">
                            <label>ุชูููุฉ ุงูุนูุงุฌ/ุฑุฃุณ</label>
                            <input type="number" id="treatmentCost" value="500">
                        </div>
                        <div class="input-group">
                            <label>ููุฏุงู ุงููุฒู %</label>
                            <input type="number" id="weightLoss" value="20">
                        </div>
                    </div>
                    <button onclick="simulateOutbreak()" style="padding: 8px 20px; background: #e74c3c; color: white; border: none; border-radius: 4px; cursor: pointer; margin-top: 10px;">
                        ูุญุงูุงุฉ ุงูุชูุดู
                    </button>
                </div>
                
                <div class="section">
                    <h3>ุฌุฏููุฉ ุงูุนูุงูุฉ</h3>
                    <div class="grid-2">
                        <div class="input-group">
                            <label>ุนุฏุฏ ุณุงุนุงุช ุงูุนูู ุงูููููุฉ</label>
                            <input type="number" id="dailyWorkHours" value="8">
                        </div>
                        <div class="input-group">
                            <label>ุนุฏุฏ ุฃูุงู ุงูุนูู ุงูุฃุณุจูุนูุฉ</label>
                            <input type="number" id="workDaysPerWeek" value="6">
                        </div>
                        <div class="input-group">
                            <label>ูุนุฏู ุงูุนูู ุงูุฅุถุงูู %</label>
                            <input type="number" id="overtimeRate" value="50">
                        </div>
                        <div class="input-group">
                            <label>ุนุฏุฏ ุฃูุงู ุงูุฅุฌุงุฒุฉ ุงูุณูููุฉ</label>
                            <input type="number" id="annualLeaveDays" value="21">
                        </div>
                    </div>
                    <button onclick="optimizeSchedule()" style="padding: 8px 20px; background: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer; margin-top: 10px;">
                        ุชุญุณูู ุงูุฌุฏููุฉ
                    </button>
                </div>
                
                <div class="section">
                    <h3>ูุญูู ุงูุนููุงุช</h3>
                    <div class="grid-3">
                        <div class="input-group">
                            <label>ุณุนุฑ ุงูุฏููุงุฑ ุงูุฃูุฑููู</label>
                            <input type="number" id="usdRate" value="31" step="0.1">
                        </div>
                        <div class="input-group">
                            <label>ุณุนุฑ ุงูููุฑู</label>
                            <input type="number" id="eurRate" value="33" step="0.1">
                        </div>
                        <div class="input-group">
                            <label>ุณุนุฑ ุงูุฑูุงู ุงูุณุนูุฏู</label>
                            <input type="number" id="sarRate" value="8.25" step="0.01">
                        </div>
                        <div class="input-group">
                            <label>ุงููุจูุบ ุจุงูุฌููู</label>
                            <input type="number" id="egpAmount" value="1000">
                        </div>
                        <div class="input-group">
                            <label>ุจุงูุฏููุงุฑ</label>
                            <input type="number" id="usdAmount" readonly>
                        </div>
                        <div class="input-group">
                            <label>ุจุงูููุฑู</label>
                            <input type="number" id="eurAmount" readonly>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Disease Impact Results -->
            <div class="chart-section">
                <h3>๐ ูุชุงุฆุฌ ุงููุญุงูุงุฉ ูุงูุชุญุณูู</h3>
                <div class="grid-2">
                    <div id="outbreakResults" style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                        <h4>ุชุฃุซูุฑ ุชูุดู ุงููุฑุถ:</h4>
                        <!-- Will be populated by JavaScript -->
                    </div>
                    <div id="scheduleResults" style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                        <h4>ุชุญุณูู ุฌุฏููุฉ ุงูุนูู:</h4>
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Export Modal -->
    <div id="reportModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="hideModal('reportModal')">&times;</span>
            <h3>๐ ุชูุฑูุฑ ุงูุฌุฏูู ุงูููุตู</h3>
            <div id="detailedReport"></div>
            <button onclick="printReport()">ุทุจุงุนุฉ ุงูุชูุฑูุฑ</button>
        </div>
    </div>
    
    <script>
        // Show tab function
        function showTab(tabName) {
            // Hide all tabs
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Remove active class from all buttons
            const buttons = document.querySelectorAll('.tab');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
            
            // Recalculate when showing financial, seasonal, breeding or risks tab
            if (tabName === 'financial' || tabName === 'seasonal' || tabName === 'breeding' || tabName === 'risks') {
                calculateAll();
                if (tabName === 'financial') {
                    setTimeout(createCharts, 100); // Delay to ensure DOM is ready
                }
            }
            
            // Handle multi-year planning tab
            if (tabName === 'multiyear') {
                calculateAll();
                setTimeout(calculateMultiYear, 100);
            }
            
            // Handle feed optimizer tab
            if (tabName === 'feedOptimizer') {
                setTimeout(optimizeFeed, 100);
            }
            
            // Handle breeding calendar tab
            if (tabName === 'breedingCalendar') {
                setTimeout(generateBreedingCalendar, 100);
            }
            
            // Handle sensitivity analysis tab
            if (tabName === 'sensitivity') {
                // Sensitivity analysis runs on demand
            }
            
            // Handle market intelligence tab
            if (tabName === 'marketIntel') {
                setTimeout(() => {
                    createPriceTrendsChart();
                    createDemandForecastChart();
                }, 100);
            }
            
            // Handle compliance tab
            if (tabName === 'compliance') {
                setTimeout(initializeCompliance, 100);
            }
            
            // Handle operations tab
            if (tabName === 'operations') {
                setTimeout(updateCurrencyConverter, 100);
            }
        }
        
        // Get all inputs
        const inputs = document.querySelectorAll('input[type="number"]');
        inputs.forEach(input => {
            input.addEventListener('input', () => {
                const activeTab = document.querySelector('.tab-content.active');
                if (activeTab && (activeTab.id === 'financial' || activeTab.id === 'seasonal' || 
                                 activeTab.id === 'breeding' || activeTab.id === 'risks')) {
                    calculateAll();
                }
            });
        });
        
        function calculateAll() {
            // Market data
            const udheyaPrice = parseFloat(document.getElementById('udheyaPrice').value) || 0;
            const meatPrice = parseFloat(document.getElementById('meatPrice').value) || 0;
            const liveAnimalPrice = parseFloat(document.getElementById('liveAnimalPrice').value) || 0;
            const cateringPrice = parseFloat(document.getElementById('cateringPrice').value) || 0;
            const eventRentalPrice = parseFloat(document.getElementById('eventRentalPrice').value) || 0;
            const manurePrice = parseFloat(document.getElementById('manurePrice').value) || 0;
            const hidePrice = parseFloat(document.getElementById('hidePrice').value) || 0;
            const exportPrice = parseFloat(document.getElementById('exportPrice').value) || 0;
            const udheyaCustomers = parseFloat(document.getElementById('udheyaCustomers').value) || 0;
            const meatDemand = parseFloat(document.getElementById('meatDemand').value) || 0;
            const liveAnimalMonthly = parseFloat(document.getElementById('liveAnimalMonthly').value) || 0;
            const cateringEvents = parseFloat(document.getElementById('cateringEvents').value) || 0;
            const cateringPeople = parseFloat(document.getElementById('cateringPeople').value) || 0;
            const eventRentals = parseFloat(document.getElementById('eventRentals').value) || 0;
            const exportMonthly = parseFloat(document.getElementById('exportMonthly').value) || 0;
            const manureProduction = parseFloat(document.getElementById('manureProduction').value) || 0;
            
            // Payment terms
            const cashCustomers = parseFloat(document.getElementById('cashCustomers').value) || 0;
            const collectionPeriod = parseFloat(document.getElementById('collectionPeriod').value) || 0;
            
            // Catering equipment
            const cateringCooking = parseFloat(document.getElementById('cateringCooking').value) || 0;
            const cateringFurniture = parseFloat(document.getElementById('cateringFurniture').value) || 0;
            const cateringServing = parseFloat(document.getElementById('cateringServing').value) || 0;
            const generator = parseFloat(document.getElementById('generator').value) || 0;
            const photography = parseFloat(document.getElementById('photography').value) || 0;
            
            // Livestock data
            const initialSheep = parseFloat(document.getElementById('initialSheep').value) || 0;
            const sheepCost = parseFloat(document.getElementById('sheepCost').value) || 0;
            const ewes = parseFloat(document.getElementById('ewes').value) || 0;
            const birthRate = parseFloat(document.getElementById('birthRate').value) || 0;
            const mortalityRate = parseFloat(document.getElementById('mortalityRate').value) || 0;
            const feedPerDay = parseFloat(document.getElementById('feedPerDay').value) || 0;
            const feedPriceTon = parseFloat(document.getElementById('feedPriceTon').value) || 0;
            const waterPerDay = parseFloat(document.getElementById('waterPerDay').value) || 0;
            const waterPrice = parseFloat(document.getElementById('waterPrice').value) || 0;
            
            // Breeding program
            const fertilityRate = parseFloat(document.getElementById('fertilityRate').value) || 0;
            const birthsPerYear = parseFloat(document.getElementById('birthsPerYear').value) || 0;
            const lambsPerBirth = parseFloat(document.getElementById('lambsPerBirth').value) || 0;
            const artificialInseminationCost = parseFloat(document.getElementById('artificialInseminationCost').value) || 0;
            const improvedRamCost = parseFloat(document.getElementById('improvedRamCost').value) || 0;
            const improvedRamsCount = parseFloat(document.getElementById('improvedRamsCount').value) || 0;
            
            // Infrastructure
            const landRent = parseFloat(document.getElementById('landRent').value) || 0;
            const shelterCost = parseFloat(document.getElementById('shelterCost').value) || 0;
            const fencingCost = parseFloat(document.getElementById('fencingCost').value) || 0;
            const waterSystem = parseFloat(document.getElementById('waterSystem').value) || 0;
            const waterRecycling = parseFloat(document.getElementById('waterRecycling').value) || 0;
            const feedingEquipment = parseFloat(document.getElementById('feedingEquipment').value) || 0;
            const feedStorage = parseFloat(document.getElementById('feedStorage').value) || 0;
            const refrigerators = parseFloat(document.getElementById('refrigerators').value) || 0;
            const freezers = parseFloat(document.getElementById('freezers').value) || 0;
            const packagingEquipment = parseFloat(document.getElementById('packagingEquipment').value) || 0;
            const biogasSystem = parseFloat(document.getElementById('biogasSystem').value) || 0;
            const otherEquipment = parseFloat(document.getElementById('otherEquipment').value) || 0;
            const vehicle = parseFloat(document.getElementById('vehicle').value) || 0;
            const refrigeratedVehicle = parseFloat(document.getElementById('refrigeratedVehicle').value) || 0;
            const transportMonthly = parseFloat(document.getElementById('transportMonthly').value) || 0;
            
            // Risk management
            const coolingSystems = parseFloat(document.getElementById('coolingSystems').value) || 0;
            const naturalDisasterInsurance = parseFloat(document.getElementById('naturalDisasterInsurance').value) || 0;
            const healthEmergency = parseFloat(document.getElementById('healthEmergency').value) || 0;
            const heatWaveMortality = parseFloat(document.getElementById('heatWaveMortality').value) || 0;
            const feedPriceVolatility = parseFloat(document.getElementById('feedPriceVolatility').value) || 0;
            
            // Taxes and fees
            const incomeTax = parseFloat(document.getElementById('incomeTax').value) || 0;
            const vat = parseFloat(document.getElementById('vat').value) || 0;
            const municipalFees = parseFloat(document.getElementById('municipalFees').value) || 0;
            const chamberFees = parseFloat(document.getElementById('chamberFees').value) || 0;
            const producerUnionFees = parseFloat(document.getElementById('producerUnionFees').value) || 0;
            
            // Export and quality
            const exportCertificates = parseFloat(document.getElementById('exportCertificates').value) || 0;
            const shippingPerHead = parseFloat(document.getElementById('shippingPerHead').value) || 0;
            const isoCertificate = parseFloat(document.getElementById('isoCertificate').value) || 0;
            const onlinePlatformFees = parseFloat(document.getElementById('onlinePlatformFees').value) || 0;
            
            // Online setup
            const website = parseFloat(document.getElementById('website').value) || 0;
            const mobileApp = parseFloat(document.getElementById('mobileApp').value) || 0;
            const paymentGateway = parseFloat(document.getElementById('paymentGateway').value) || 0;
            const inventorySystem = parseFloat(document.getElementById('inventorySystem').value) || 0;
            
            // Operations
            const workers = parseFloat(document.getElementById('workers').value) || 0;
            const workerSalary = parseFloat(document.getElementById('workerSalary').value) || 0;
            const managerSalary = parseFloat(document.getElementById('managerSalary').value) || 0;
            const vaccinesPerHead = parseFloat(document.getElementById('vaccinesPerHead').value) || 0;
            const vetEmergency = parseFloat(document.getElementById('vetEmergency').value) || 0;
            const vetCheckup = parseFloat(document.getElementById('vetCheckup').value) || 0;
            const utilities = parseFloat(document.getElementById('utilities').value) || 0;
            const marketing = parseFloat(document.getElementById('marketing').value) || 0;
            const digitalMarketing = parseFloat(document.getElementById('digitalMarketing').value) || 0;
            const insurance = parseFloat(document.getElementById('insurance').value) || 0;
            const licenses = parseFloat(document.getElementById('licenses').value) || 0;
            const halalCertificate = parseFloat(document.getElementById('halalCertificate').value) || 0;
            const qualityCertificates = parseFloat(document.getElementById('qualityCertificates').value) || 0;
            
            // Processing costs
            const slaughterFee = parseFloat(document.getElementById('slaughterFee').value) || 0;
            const processingFee = parseFloat(document.getElementById('processingFee').value) || 0;
            const packagingMonthly = parseFloat(document.getElementById('packagingMonthly').value) || 0;
            const cateringStaffPerEvent = parseFloat(document.getElementById('cateringStaffPerEvent').value) || 0;
            const deliveryCost = parseFloat(document.getElementById('deliveryCost').value) || 0;
            
            // Calculations
            // Update rams needed
            document.getElementById('ramsNeeded').value = Math.ceil(ewes / 25);
            
            // Update credit customers
            document.getElementById('creditCustomers').value = 100 - cashCustomers;
            
            // Total catering equipment
            const cateringEquipmentTotal = cateringCooking + cateringFurniture + cateringServing + generator + photography;
            
            // Infrastructure total
            const infrastructureTotal = shelterCost + fencingCost + waterSystem + waterRecycling +
                                      feedingEquipment + feedStorage + refrigerators + freezers +
                                      packagingEquipment + biogasSystem + otherEquipment + vehicle + 
                                      refrigeratedVehicle + cateringEquipmentTotal + coolingSystems;
            
            // Online setup total
            const onlineSetupTotal = website + mobileApp + paymentGateway + inventorySystem;
            
            // Breeding investment
            const breedingInvestment = improvedRamCost * improvedRamsCount;
            
            // Export setup costs
            const exportSetupCosts = exportCertificates + isoCertificate;
            
            // Flock cost
            const flockCost = initialSheep * sheepCost + breedingInvestment;
            
            // Monthly operating costs
            const laborCost = (workers * workerSalary) + managerSalary;
            const feedCostMonthly = (initialSheep * feedPerDay * 30 * feedPriceTon) / 1000;
            const waterCostMonthly = (initialSheep * waterPerDay * 30 * waterPrice) / 1000;
            const vetCostMonthly = vetEmergency + vetCheckup;
            const processingCostMonthly = (slaughterFee + processingFee) * (udheyaCustomers/12 + liveAnimalMonthly + exportMonthly);
            const cateringStaffMonthly = cateringStaffPerEvent * cateringEvents;
            const exportShippingMonthly = shippingPerHead * exportMonthly;
            const breedingCostMonthly = (artificialInseminationCost * ewes * birthsPerYear) / 12;
            const monthlyOperating = laborCost + feedCostMonthly + waterCostMonthly + vetCostMonthly + 
                                   utilities + marketing + digitalMarketing + transportMonthly +
                                   packagingMonthly + processingCostMonthly + cateringStaffMonthly + 
                                   deliveryCost + exportShippingMonthly + breedingCostMonthly;
            
            // Annual operating costs
            const annualFees = municipalFees + chamberFees + producerUnionFees + onlinePlatformFees;
            const annualOperating = (monthlyOperating * 12) + (vaccinesPerHead * initialSheep) + 
                                  insurance + licenses + landRent + halalCertificate + qualityCertificates +
                                  naturalDisasterInsurance + annualFees;
            
            // Risk reserve
            const healthReserve = flockCost * (healthEmergency / 100);
            const feedPriceReserve = feedCostMonthly * 12 * (feedPriceVolatility / 100);
            const totalRiskReserve = healthReserve + feedPriceReserve;
            
            // Working capital (4 months considering payment terms)
            const workingCapitalMonths = 4 + (collectionPeriod / 30);
            const workingCapital = monthlyOperating * workingCapitalMonths + totalRiskReserve;
            
            // Total investment
            const totalInvestment = infrastructureTotal + flockCost + workingCapital + onlineSetupTotal + exportSetupCosts;
            
            // Revenue calculations with improved breeding
            const effectiveFertility = fertilityRate / 100;
            const expectedLambs = ewes * effectiveFertility * birthsPerYear * lambsPerBirth;
            const effectiveMortality = (mortalityRate + heatWaveMortality) / 100;
            const survivalRate = 1 - effectiveMortality;
            const sellableSheep = expectedLambs * survivalRate;
            
            const udheyaRevenue = Math.min(udheyaCustomers, sellableSheep * 0.4) * udheyaPrice;
            const meatRevenue = meatDemand * 12 * meatPrice;
            const liveAnimalRevenue = liveAnimalMonthly * 12 * liveAnimalPrice;
            const cateringRevenue = cateringEvents * 12 * cateringPeople * cateringPrice;
            const eventRentalRevenue = eventRentals * 12 * eventRentalPrice;
            const exportRevenue = exportMonthly * 12 * exportPrice;
            const manureRevenue = manureProduction * manurePrice;
            const hideRevenue = (sellableSheep * 0.8) * hidePrice;
            
            const totalRevenue = udheyaRevenue + meatRevenue + liveAnimalRevenue + cateringRevenue + 
                               eventRentalRevenue + exportRevenue + manureRevenue + hideRevenue;
            
            // Calculate Zakat
            const zakatDue = initialSheep >= 40 ? Math.floor(initialSheep / 40) : 0;
            const zakatValue = zakatDue * sheepCost;
            document.getElementById('zakatDue').value = zakatDue;
            document.getElementById('zakatValue').value = zakatValue;
            
            // First year calculations
            const firstYearCosts = totalInvestment + annualOperating + zakatValue;
            const firstYearProfitBeforeTax = totalRevenue - firstYearCosts;
            const taxAmount = firstYearProfitBeforeTax > 0 ? firstYearProfitBeforeTax * (incomeTax / 100) : 0;
            const firstYearProfit = firstYearProfitBeforeTax - taxAmount;
            
            // Break-even
            let breakEvenMonths = 0;
            if (totalRevenue > annualOperating) {
                const monthlyProfit = (totalRevenue - annualOperating) / 12;
                breakEvenMonths = Math.ceil(totalInvestment / monthlyProfit);
            } else {
                breakEvenMonths = 999;
            }
            
            // ROI and margins
            const roi = totalInvestment > 0 ? ((firstYearProfit / totalInvestment) * 100).toFixed(1) : 0;
            const profitMargin = totalRevenue > 0 ? ((firstYearProfit / totalRevenue) * 100).toFixed(1) : 0;
            
            // Seasonal analysis
            const eidSalesPercent = parseFloat(document.getElementById('eidSales').value) || 85;
            const monthlyAvgRevenue = totalRevenue / 12;
            const eidMonthRevenue = (udheyaRevenue * eidSalesPercent / 100) + (monthlyAvgRevenue * 0.5);
            const lowestMonthRevenue = monthlyAvgRevenue * 0.6;
            const cashReserveNeeded = monthlyOperating * 6 + totalRiskReserve;
            
            // Update displays
            document.getElementById('totalInvestment').textContent = totalInvestment.toLocaleString();
            document.getElementById('yearOneRevenue').textContent = totalRevenue.toLocaleString();
            document.getElementById('yearOneCosts').textContent = firstYearCosts.toLocaleString();
            document.getElementById('yearOneProfit').textContent = firstYearProfit.toLocaleString();
            document.getElementById('breakEven').textContent = breakEvenMonths === 999 ? 'ูู ูุชุนุงุฏู' : breakEvenMonths;
            document.getElementById('roi').textContent = roi;
            document.getElementById('infraTotal').textContent = infrastructureTotal.toLocaleString();
            document.getElementById('flockTotal').textContent = flockCost.toLocaleString();
            document.getElementById('workingCapital').textContent = workingCapital.toLocaleString();
            document.getElementById('monthlyOperating').textContent = monthlyOperating.toLocaleString();
            document.getElementById('onlineTotal').textContent = onlineSetupTotal.toLocaleString();
            document.getElementById('processingCosts').textContent = processingCostMonthly.toLocaleString();
            document.getElementById('digitalMarketingCost').textContent = digitalMarketing.toLocaleString();
            document.getElementById('udheyaRevenue').textContent = udheyaRevenue.toLocaleString();
            document.getElementById('meatRevenue').textContent = meatRevenue.toLocaleString();
            document.getElementById('liveAnimalRevenue').textContent = liveAnimalRevenue.toLocaleString();
            document.getElementById('cateringRevenue').textContent = cateringRevenue.toLocaleString();
            document.getElementById('eventRentalRevenue').textContent = eventRentalRevenue.toLocaleString();
            document.getElementById('profitMargin').textContent = profitMargin;
            document.getElementById('paybackPeriod').textContent = breakEvenMonths === 999 ? 'ุบูุฑ ูุญุฏุฏ' : breakEvenMonths;
            document.getElementById('requiredCashReserve').textContent = cashReserveNeeded.toLocaleString();
            
            // Seasonal displays
            document.getElementById('nonEidSales').value = 100 - eidSalesPercent;
            document.getElementById('highestCashNeed').textContent = 'ุฐู ุงููุนุฏุฉ';
            document.getElementById('lowestRevenue').textContent = lowestMonthRevenue.toLocaleString();
            document.getElementById('highestRevenue').textContent = eidMonthRevenue.toLocaleString();
            document.getElementById('cashReserve').textContent = cashReserveNeeded.toLocaleString();
            
            // Update additional revenue displays
            document.getElementById('exportRevenue').textContent = exportRevenue.toLocaleString();
            document.getElementById('manureRevenue').textContent = manureRevenue.toLocaleString();
            document.getElementById('hideRevenue').textContent = hideRevenue.toLocaleString();
            document.getElementById('zakatDisplay').textContent = zakatValue.toLocaleString();
            document.getElementById('taxDisplay').textContent = taxAmount.toLocaleString();
            document.getElementById('riskReserveDisplay').textContent = totalRiskReserve.toLocaleString();
            document.getElementById('waterCostDisplay').textContent = waterCostMonthly.toLocaleString();
            
            // Decision
            const decisionBox = document.getElementById('decisionBox');
            if (firstYearProfit > 0 && breakEvenMonths <= 12) {
                decisionBox.textContent = 'โ ููุชุงุฒ - ุงููุดุฑูุน ูุฑุจุญ ูู ุงูุณูุฉ ุงูุฃููู!';
                decisionBox.className = 'decision-box go';
            } else if (firstYearProfit > 0 || (breakEvenMonths <= 18 && totalRevenue > annualOperating)) {
                decisionBox.textContent = 'โ๏ธ ุฌูุฏ - ูุญุชุงุฌ ูุฑุงุฌุนุฉ ุจุนุถ ุงูุชูุงุตูู';
                decisionBox.className = 'decision-box maybe';
            } else {
                decisionBox.textContent = 'โ ุบูุฑ ูุฌุฏู - ุงููุดุฑูุน ูุญุชุงุฌ ุฅุนุงุฏุฉ ุฏุฑุงุณุฉ';
                decisionBox.className = 'decision-box no-go';
            }
            
            // Update quick summary
            const quickSummary = document.getElementById('quickSummary');
            if (quickSummary) {
                quickSummary.style.display = 'block';
                document.getElementById('quickProfit').textContent = firstYearProfit > 0 ? 
                    '+' + (firstYearProfit / 1000).toFixed(0) + 'k' : 
                    (firstYearProfit / 1000).toFixed(0) + 'k';
                document.getElementById('quickInvestment').textContent = (totalInvestment / 1000).toFixed(0) + 'k';
                document.getElementById('quickROI').textContent = roi + '%';
                document.getElementById('quickBreakeven').textContent = breakEvenMonths === 999 ? 'โ' : breakEvenMonths;
                document.getElementById('quickRevenue').textContent = (totalRevenue / 1000).toFixed(0) + 'k';
                document.getElementById('quickMargin').textContent = profitMargin + '%';
            }
        }
        
        // Charts storage
        let charts = {};
        
        // Data Management Functions
        function saveProject() {
            const projectData = {
                timestamp: new Date().toISOString(),
                projectName: prompt('ุงุณู ุงููุดุฑูุน:', 'ูุดุฑูุน ุชุฑุจูุฉ ุงูุฃุบูุงู') || 'ูุดุฑูุน ุชุฑุจูุฉ ุงูุฃุบูุงู',
                data: {}
            };
            
            // Collect all input values
            const inputs = document.querySelectorAll('input[type="number"], select');
            inputs.forEach(input => {
                projectData.data[input.id] = input.value;
            });
            
            const blob = new Blob([JSON.stringify(projectData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${projectData.projectName.replace(/\s+/g, '_')}_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            alert('ุชู ุญูุธ ุงููุดุฑูุน ุจูุฌุงุญ!');
        }
        
        function loadProject(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const projectData = JSON.parse(e.target.result);
                    
                    // Load all values
                    Object.entries(projectData.data).forEach(([id, value]) => {
                        const element = document.getElementById(id);
                        if (element) {
                            element.value = value;
                        }
                    });
                    
                    calculateAll();
                    alert(`ุชู ุชุญููู ุงููุดุฑูุน: ${projectData.projectName}`);
                } catch (error) {
                    alert('ุฎุทุฃ ูู ุชุญููู ุงูููู');
                }
            };
            reader.readAsText(file);
        }
        
        function exportToPDF() {
            if (typeof jsPDF === 'undefined') {
                alert('ููุชุจุฉ PDF ุบูุฑ ูุชููุฑุฉ');
                return;
            }
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Add Arabic font support (basic)
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(16);
            doc.text('Sheep Farming Feasibility Report', 20, 20);
            
            // Add key metrics
            doc.setFontSize(12);
            let y = 40;
            const metrics = [
                ['Total Investment', document.getElementById('totalInvestment').textContent],
                ['Year 1 Revenue', document.getElementById('yearOneRevenue').textContent],
                ['Year 1 Profit', document.getElementById('yearOneProfit').textContent],
                ['Break Even', document.getElementById('breakEven').textContent + ' months'],
                ['ROI', document.getElementById('roi').textContent + '%']
            ];
            
            metrics.forEach(([label, value]) => {
                doc.text(`${label}: ${value}`, 20, y);
                y += 10;
            });
            
            doc.save('sheep_farming_report.pdf');
        }
        
        function exportToExcel() {
            // Simple CSV export (Excel compatible)
            const data = [
                ['ุงูุจูุงู', 'ุงููููุฉ'],
                ['ุฅุฌูุงูู ุงูุงุณุชุซูุงุฑ', document.getElementById('totalInvestment').textContent],
                ['ุฅูุฑุงุฏุงุช ุงูุณูุฉ 1', document.getElementById('yearOneRevenue').textContent],
                ['ุตุงูู ุงูุฑุจุญ', document.getElementById('yearOneProfit').textContent],
                ['ููุทุฉ ุงูุชุนุงุฏู', document.getElementById('breakEven').textContent],
                ['ุงูุนุงุฆุฏ', document.getElementById('roi').textContent + '%']
            ];
            
            const csvContent = data.map(row => row.join(',')).join('\n');
            const blob = new Blob(["\uFEFF" + csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'sheep_farming_analysis.csv';
            a.click();
            URL.revokeObjectURL(url);
        }
        
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
            if (modalId === 'reportModal') {
                generateDetailedReport();
            }
        }
        
        function hideModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        function generateDetailedReport() {
            const report = `
                <div style="text-align: right; direction: rtl; line-height: 1.6;">
                    <h4>๐ ููุฎุต ุงููุดุฑูุน</h4>
                    <p><strong>ุฅุฌูุงูู ุงูุงุณุชุซูุงุฑ:</strong> ${document.getElementById('totalInvestment').textContent} ุฌููู</p>
                    <p><strong>ุฅูุฑุงุฏุงุช ุงูุณูุฉ ุงูุฃููู:</strong> ${document.getElementById('yearOneRevenue').textContent} ุฌููู</p>
                    <p><strong>ุตุงูู ุงูุฑุจุญ:</strong> ${document.getElementById('yearOneProfit').textContent} ุฌููู</p>
                    <p><strong>ููุทุฉ ุงูุชุนุงุฏู:</strong> ${document.getElementById('breakEven').textContent} ุดูุฑ</p>
                    <p><strong>ุงูุนุงุฆุฏ ุนูู ุงูุงุณุชุซูุงุฑ:</strong> ${document.getElementById('roi').textContent}%</p>
                    
                    <h4>๐ ุชูุฒูุน ุงูุฅูุฑุงุฏุงุช</h4>
                    <p><strong>ุฃุถุงุญู:</strong> ${document.getElementById('udheyaRevenue').textContent} ุฌููู</p>
                    <p><strong>ูุญูู:</strong> ${document.getElementById('meatRevenue').textContent} ุฌููู</p>
                    <p><strong>ุญููุงูุงุช ุญูุฉ:</strong> ${document.getElementById('liveAnimalRevenue').textContent} ุฌููู</p>
                    <p><strong>ูุงุชุฑููุฌ:</strong> ${document.getElementById('cateringRevenue').textContent} ุฌููู</p>
                    
                    <h4>๐ฐ ูููู ุงูุชูุงููู</h4>
                    <p><strong>ุงูุจููุฉ ุงูุชุญุชูุฉ:</strong> ${document.getElementById('infraTotal').textContent} ุฌููู</p>
                    <p><strong>ุงููุทูุน:</strong> ${document.getElementById('flockTotal').textContent} ุฌููู</p>
                    <p><strong>ุฑุฃุณ ุงููุงู ุงูุนุงูู:</strong> ${document.getElementById('workingCapital').textContent} ุฌููู</p>
                </div>
            `;
            document.getElementById('detailedReport').innerHTML = report;
        }
        
        function printReport() {
            const reportContent = document.getElementById('detailedReport').innerHTML;
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>ุชูุฑูุฑ ุฌุฏูู ูุดุฑูุน ุชุฑุจูุฉ ุงูุฃุบูุงู</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        h4 { color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 5px; }
                    </style>
                </head>
                <body>
                    <h2>๐ ุชูุฑูุฑ ุฌุฏูู ูุดุฑูุน ุชุฑุจูุฉ ุงูุฃุบูุงู</h2>
                    ${reportContent}
                    <hr>
                    <p style="font-size: 0.8em; color: #666; text-align: center;">
                        ุชู ุฅูุดุงุก ูุฐุง ุงูุชูุฑูุฑ ูู ${new Date().toLocaleDateString('ar-EG')}
                    </p>
                </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }
        
        // Chart Creation Functions
        function createCharts() {
            createCashFlowChart();
            createRevenueChart();
            createBreakEvenChart();
            createCostBreakdownChart();
        }
        
        function createCashFlowChart() {
            const ctx = document.getElementById('cashFlowChart');
            if (!ctx) return;
            
            if (charts.cashFlow) {
                charts.cashFlow.destroy();
            }
            
            const monthlyRevenue = parseFloat(document.getElementById('yearOneRevenue').textContent.replace(/,/g, '')) / 12;
            const monthlyOperating = parseFloat(document.getElementById('monthlyOperating').textContent.replace(/,/g, ''));
            const totalInvestment = parseFloat(document.getElementById('totalInvestment').textContent.replace(/,/g, ''));
            
            let cumulativeCash = -totalInvestment;
            const cashFlowData = [];
            
            for (let i = 1; i <= 12; i++) {
                const monthlyProfit = monthlyRevenue - monthlyOperating;
                cumulativeCash += monthlyProfit;
                cashFlowData.push(cumulativeCash);
            }
            
            charts.cashFlow = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['ููุงูุฑ', 'ูุจุฑุงูุฑ', 'ูุงุฑุณ', 'ุฃุจุฑูู', 'ูุงูู', 'ููููู', 'ููููู', 'ุฃุบุณุทุณ', 'ุณุจุชูุจุฑ', 'ุฃูุชูุจุฑ', 'ููููุจุฑ', 'ุฏูุณูุจุฑ'],
                    datasets: [{
                        label: 'ุงูุชุฏูู ุงูููุฏู ุงููุชุฑุงูู',
                        data: cashFlowData,
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ุชุญููู ุงูุชุฏูู ุงูููุฏู (12 ุดูุฑ)'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString() + ' ุฌููู';
                                }
                            }
                        }
                    }
                }
            });
        }
        
        function createRevenueChart() {
            const ctx = document.getElementById('revenueChart');
            if (!ctx) return;
            
            if (charts.revenue) {
                charts.revenue.destroy();
            }
            
            const revenueData = [
                parseFloat(document.getElementById('udheyaRevenue').textContent.replace(/,/g, '')),
                parseFloat(document.getElementById('meatRevenue').textContent.replace(/,/g, '')),
                parseFloat(document.getElementById('liveAnimalRevenue').textContent.replace(/,/g, '')),
                parseFloat(document.getElementById('cateringRevenue').textContent.replace(/,/g, '')),
                parseFloat(document.getElementById('exportRevenue').textContent.replace(/,/g, '')),
                parseFloat(document.getElementById('manureRevenue').textContent.replace(/,/g, ''))
            ];
            
            charts.revenue = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['ุฃุถุงุญู', 'ูุญูู', 'ุญููุงูุงุช ุญูุฉ', 'ูุงุชุฑููุฌ', 'ุชุตุฏูุฑ', 'ุณูุงุฏ'],
                    datasets: [{
                        data: revenueData,
                        backgroundColor: [
                            '#e74c3c',
                            '#3498db',
                            '#2ecc71',
                            '#f39c12',
                            '#9b59b6',
                            '#1abc9c'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ุชูุฒูุน ูุตุงุฏุฑ ุงูุฅูุฑุงุฏ'
                        }
                    }
                }
            });
        }
        
        function createBreakEvenChart() {
            const ctx = document.getElementById('breakEvenChart');
            if (!ctx) return;
            
            if (charts.breakEven) {
                charts.breakEven.destroy();
            }
            
            const monthlyRevenue = parseFloat(document.getElementById('yearOneRevenue').textContent.replace(/,/g, '')) / 12;
            const monthlyOperating = parseFloat(document.getElementById('monthlyOperating').textContent.replace(/,/g, ''));
            const totalInvestment = parseFloat(document.getElementById('totalInvestment').textContent.replace(/,/g, ''));
            
            const months = [];
            const cumulativeRevenue = [];
            const cumulativeCosts = [];
            
            let totalRev = 0;
            let totalCost = totalInvestment;
            
            for (let i = 1; i <= 24; i++) {
                months.push(i);
                totalRev += monthlyRevenue;
                totalCost += monthlyOperating;
                cumulativeRevenue.push(totalRev);
                cumulativeCosts.push(totalCost);
            }
            
            charts.breakEven = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: months,
                    datasets: [
                        {
                            label: 'ุฅุฌูุงูู ุงูุฅูุฑุงุฏุงุช',
                            data: cumulativeRevenue,
                            borderColor: '#2ecc71',
                            backgroundColor: 'rgba(46, 204, 113, 0.1)',
                            tension: 0.4
                        },
                        {
                            label: 'ุฅุฌูุงูู ุงูุชูุงููู',
                            data: cumulativeCosts,
                            borderColor: '#e74c3c',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ุชุญููู ููุทุฉ ุงูุชุนุงุฏู (24 ุดูุฑ)'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return (value / 1000000).toFixed(1) + 'ู ุฌููู';
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'ุงูุดูุฑ'
                            }
                        }
                    }
                }
            });
        }
        
        function createCostBreakdownChart() {
            const ctx = document.getElementById('costBreakdownChart');
            if (!ctx) return;
            
            if (charts.costBreakdown) {
                charts.costBreakdown.destroy();
            }
            
            const costData = [
                parseFloat(document.getElementById('infraTotal').textContent.replace(/,/g, '')),
                parseFloat(document.getElementById('flockTotal').textContent.replace(/,/g, '')),
                parseFloat(document.getElementById('workingCapital').textContent.replace(/,/g, '')),
                parseFloat(document.getElementById('monthlyOperating').textContent.replace(/,/g, '')) * 12
            ];
            
            charts.costBreakdown = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['ุงูุจููุฉ ุงูุชุญุชูุฉ', 'ุงููุทูุน', 'ุฑุฃุณ ุงููุงู', 'ุชุดุบูู ุณููู'],
                    datasets: [{
                        label: 'ุงูุชูููุฉ (ุฌููู)',
                        data: costData,
                        backgroundColor: [
                            '#3498db',
                            '#e74c3c',
                            '#f39c12',
                            '#9b59b6'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ุชูุฒูุน ุงูุชูุงููู'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return (value / 1000).toFixed(0) + 'ุฃูู';
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Multi-year planning functions
        function calculateMultiYear() {
            const flockGrowth = parseFloat(document.getElementById('flockGrowthRate').value) || 25;
            const productivityGrowth = parseFloat(document.getElementById('productivityImprovement').value) || 5;
            const priceInflation = parseFloat(document.getElementById('priceInflation').value) || 8;
            const costInflation = parseFloat(document.getElementById('costInflation').value) || 6;
            
            const expansion2 = parseFloat(document.getElementById('expansion2').value) || 0;
            const expansion3 = parseFloat(document.getElementById('expansion3').value) || 0;
            const expansion5 = parseFloat(document.getElementById('expansion5').value) || 0;
            
            // Base year values
            const baseRevenue = parseFloat(document.getElementById('yearOneRevenue').textContent.replace(/,/g, ''));
            const baseCosts = parseFloat(document.getElementById('yearOneCosts').textContent.replace(/,/g, ''));
            const baseInvestment = parseFloat(document.getElementById('totalInvestment').textContent.replace(/,/g, ''));
            const baseFlock = parseFloat(document.getElementById('initialSheep').value);
            
            const projections = [];
            
            for (let year = 1; year <= 5; year++) {
                const flockSize = Math.round(baseFlock * Math.pow(1 + flockGrowth/100, year - 1));
                const revenue = baseRevenue * Math.pow(1 + priceInflation/100, year - 1) * Math.pow(1 + productivityGrowth/100, year - 1);
                const operatingCosts = (baseCosts - baseInvestment) * Math.pow(1 + costInflation/100, year - 1);
                
                let additionalInvestment = 0;
                if (year === 2) additionalInvestment = expansion2;
                if (year === 3) additionalInvestment = expansion3;
                if (year === 5) additionalInvestment = expansion5;
                
                const totalCosts = operatingCosts + additionalInvestment;
                const profit = revenue - totalCosts;
                const roi = baseInvestment > 0 ? (profit / baseInvestment * 100) : 0;
                
                projections.push({
                    year,
                    flockSize,
                    revenue: Math.round(revenue),
                    costs: Math.round(totalCosts),
                    profit: Math.round(profit),
                    roi: roi.toFixed(1),
                    investment: additionalInvestment
                });
            }
            
            updateMultiYearTable(projections);
            createMultiYearCharts(projections);
        }
        
        function updateMultiYearTable(projections) {
            const tbody = document.getElementById('fiveYearTableBody');
            if (!tbody) return;
            
            const rows = [
                ['ุนุฏุฏ ุงูุฃุบูุงู', projections.map(p => p.flockSize.toLocaleString())],
                ['ุงูุฅูุฑุงุฏุงุช', projections.map(p => p.revenue.toLocaleString())],
                ['ุงูุชูุงููู', projections.map(p => p.costs.toLocaleString())],
                ['ุตุงูู ุงูุฑุจุญ', projections.map(p => p.profit.toLocaleString())],
                ['ุงูุนุงุฆุฏ %', projections.map(p => p.roi + '%')],
                ['ุงุณุชุซูุงุฑุงุช ุฅุถุงููุฉ', projections.map(p => p.investment.toLocaleString())]
            ];
            
            tbody.innerHTML = rows.map(([label, values]) => `
                <tr>
                    <td style="padding: 6px; border: 1px solid #ddd; font-weight: bold; background: #f8f9fa;">${label}</td>
                    ${values.map(value => `<td style="padding: 6px; border: 1px solid #ddd; text-align: center;">${value}</td>`).join('')}
                </tr>
            `).join('');
        }
        
        function createMultiYearCharts(projections) {
            createMultiYearRevenueChart(projections);
            createFlockGrowthChart(projections);
        }
        
        function createMultiYearRevenueChart(projections) {
            const ctx = document.getElementById('multiYearRevenueChart');
            if (!ctx) return;
            
            if (charts.multiYearRevenue) {
                charts.multiYearRevenue.destroy();
            }
            
            charts.multiYearRevenue = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: projections.map(p => `ุงูุณูุฉ ${p.year}`),
                    datasets: [
                        {
                            label: 'ุงูุฅูุฑุงุฏุงุช',
                            data: projections.map(p => p.revenue),
                            borderColor: '#2ecc71',
                            backgroundColor: 'rgba(46, 204, 113, 0.1)',
                            tension: 0.4
                        },
                        {
                            label: 'ุงูุชูุงููู',
                            data: projections.map(p => p.costs),
                            borderColor: '#e74c3c',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            tension: 0.4
                        },
                        {
                            label: 'ุตุงูู ุงูุฑุจุญ',
                            data: projections.map(p => p.profit),
                            borderColor: '#3498db',
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ุงูุฃุฏุงุก ุงููุงูู ุนูู 5 ุณููุงุช'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return (value / 1000000).toFixed(1) + 'ู';
                                }
                            }
                        }
                    }
                }
            });
        }
        
        function createFlockGrowthChart(projections) {
            const ctx = document.getElementById('flockGrowthChart');
            if (!ctx) return;
            
            if (charts.flockGrowth) {
                charts.flockGrowth.destroy();
            }
            
            charts.flockGrowth = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: projections.map(p => `ุงูุณูุฉ ${p.year}`),
                    datasets: [{
                        label: 'ุนุฏุฏ ุงูุฃุบูุงู',
                        data: projections.map(p => p.flockSize),
                        backgroundColor: '#9b59b6',
                        borderColor: '#8e44ad',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ููู ุญุฌู ุงููุทูุน'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return value + ' ุฑุฃุณ';
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Feed optimizer functions
        function optimizeFeed() {
            // Simple feed optimization algorithm
            const cornPrice = parseFloat(document.getElementById('cornPrice').value) || 8000;
            const soybeanPrice = parseFloat(document.getElementById('soybeanPrice').value) || 15000;
            const wheatBranPrice = parseFloat(document.getElementById('wheatBranPrice').value) || 6000;
            const barleyPrice = parseFloat(document.getElementById('barleyPrice').value) || 7000;
            const concentratePrice = parseFloat(document.getElementById('concentratePrice').value) || 12000;
            const alfalfaPrice = parseFloat(document.getElementById('alfalfaPrice').value) || 4000;
            
            const requiredProtein = parseFloat(document.getElementById('requiredProtein').value) || 16;
            const requiredEnergy = parseFloat(document.getElementById('requiredEnergy').value) || 2.8;
            const maxFiber = parseFloat(document.getElementById('maxFiber').value) || 18;
            
            // Feed components with nutritional values
            const feeds = {
                corn: { price: cornPrice, protein: 8, energy: 3.2, fiber: 2 },
                soybean: { price: soybeanPrice, protein: 44, energy: 2.2, fiber: 6 },
                wheatBran: { price: wheatBranPrice, protein: 15, energy: 2.0, fiber: 12 },
                barley: { price: barleyPrice, protein: 11, energy: 2.8, fiber: 5 },
                concentrate: { price: concentratePrice, protein: 18, energy: 2.7, fiber: 8 },
                alfalfa: { price: alfalfaPrice, protein: 17, energy: 2.2, fiber: 28 }
            };
            
            // Simple optimization (this is a simplified version)
            // In real implementation, you would use linear programming
            let bestCost = Infinity;
            let bestFormula = null;
            
            // Try different combinations
            for (let corn = 20; corn <= 50; corn += 5) {
                for (let soybean = 10; soybean <= 25; soybean += 5) {
                    for (let concentrate = 15; concentrate <= 35; concentrate += 5) {
                        const remaining = 100 - corn - soybean - concentrate;
                        if (remaining < 0) continue;
                        
                        const alfalfa = Math.min(remaining, 30);
                        const wheatBran = remaining - alfalfa;
                        
                        if (wheatBran < 0) continue;
                        
                        const formula = { corn, soybean, wheatBran, concentrate, alfalfa, barley: 0 };
                        
                        // Calculate nutritional values
                        let totalProtein = 0;
                        let totalEnergy = 0;
                        let totalFiber = 0;
                        let totalCost = 0;
                        
                        Object.entries(formula).forEach(([feed, percentage]) => {
                            const feedData = feeds[feed];
                            totalProtein += (percentage / 100) * feedData.protein;
                            totalEnergy += (percentage / 100) * feedData.energy;
                            totalFiber += (percentage / 100) * feedData.fiber;
                            totalCost += (percentage / 100) * feedData.price;
                        });
                        
                        // Check constraints
                        if (totalProtein >= requiredProtein && 
                            totalEnergy >= requiredEnergy && 
                            totalFiber <= maxFiber &&
                            totalCost < bestCost) {
                            bestCost = totalCost;
                            bestFormula = {
                                formula,
                                protein: totalProtein.toFixed(1),
                                energy: totalEnergy.toFixed(1),
                                fiber: totalFiber.toFixed(1),
                                cost: totalCost.toFixed(0)
                            };
                        }
                    }
                }
            }
            
            updateFeedFormula(bestFormula);
            createFeedCompositionChart(bestFormula);
        }
        
        function updateFeedFormula(formula) {
            const container = document.getElementById('optimalFormula');
            const costElement = document.getElementById('optimalCost');
            
            if (!formula) {
                container.innerHTML = '<p style="color: red;">ูู ูุชู ุงูุนุซูุฑ ุนูู ุชุฑููุจุฉ ูุซูู ุชุญูู ุงููุชุทูุจุงุช</p>';
                costElement.textContent = 'ุบูุฑ ูุญุฏุฏ';
                return;
            }
            
            const feedNames = {
                corn: 'ุฐุฑุฉ',
                soybean: 'ูุณุจ ููู ุตููุง',
                wheatBran: 'ูุฎุงูุฉ ููุญ',
                barley: 'ุดุนูุฑ',
                concentrate: 'ุนูู ูุฑูุฒ',
                alfalfa: 'ุฏุฑูุณ ุจุฑุณูู'
            };
            
            const formulaHTML = Object.entries(formula.formula)
                .filter(([, percentage]) => percentage > 0)
                .map(([feed, percentage]) => 
                    `<div style="margin: 5px 0;"><strong>${feedNames[feed]}:</strong> ${percentage}%</div>`
                ).join('');
            
            container.innerHTML = `
                <div style="margin-bottom: 10px;">${formulaHTML}</div>
                <div style="background: #e8f4f8; padding: 8px; border-radius: 4px; font-size: 0.9em;">
                    <div><strong>ุงูุจุฑูุชูู:</strong> ${formula.protein}%</div>
                    <div><strong>ุงูุทุงูุฉ:</strong> ${formula.energy} ููุฌุง ูุงููุฑู/ูุฌู</div>
                    <div><strong>ุงูุฃููุงู:</strong> ${formula.fiber}%</div>
                </div>
            `;
            
            costElement.textContent = formula.cost;
        }
        
        function createFeedCompositionChart(formula) {
            const ctx = document.getElementById('feedCompositionChart');
            if (!ctx || !formula) return;
            
            if (charts.feedComposition) {
                charts.feedComposition.destroy();
            }
            
            const feedNames = {
                corn: 'ุฐุฑุฉ',
                soybean: 'ูุณุจ ููู ุตููุง',
                wheatBran: 'ูุฎุงูุฉ ููุญ',
                barley: 'ุดุนูุฑ',
                concentrate: 'ุนูู ูุฑูุฒ',
                alfalfa: 'ุฏุฑูุณ ุจุฑุณูู'
            };
            
            const data = Object.entries(formula.formula)
                .filter(([, percentage]) => percentage > 0)
                .map(([feed, percentage]) => ({ feed: feedNames[feed], percentage }));
            
            charts.feedComposition = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: data.map(d => d.feed),
                    datasets: [{
                        data: data.map(d => d.percentage),
                        backgroundColor: [
                            '#f39c12',
                            '#e74c3c',
                            '#3498db',
                            '#2ecc71',
                            '#9b59b6',
                            '#1abc9c'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ุชุฑููุจุฉ ุงูุนูู ุงููุซูู'
                        },
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }
        
        // Breeding calendar functions
        function generateBreedingCalendar() {
            const breeding1Start = new Date(document.getElementById('breeding1Start').value);
            const breeding2Start = new Date(document.getElementById('breeding2Start').value);
            const breedingDuration = parseInt(document.getElementById('breedingDuration').value) || 45;
            const gestationDays = parseInt(document.getElementById('gestationDays').value) || 150;
            const lactationDays = parseInt(document.getElementById('lactationPeriod').value) || 90;
            
            const events = [];
            
            // First breeding season
            events.push({
                date: new Date(breeding1Start),
                event: 'ุจุฏุงูุฉ ููุณู ุงูุชูููุญ ุงูุฃูู',
                type: 'breeding',
                priority: 'high'
            });
            
            const breeding1End = new Date(breeding1Start);
            breeding1End.setDate(breeding1End.getDate() + breedingDuration);
            events.push({
                date: new Date(breeding1End),
                event: 'ููุงูุฉ ููุณู ุงูุชูููุญ ุงูุฃูู',
                type: 'breeding',
                priority: 'medium'
            });
            
            const birth1Start = new Date(breeding1Start);
            birth1Start.setDate(birth1Start.setDate() + gestationDays);
            events.push({
                date: new Date(birth1Start),
                event: 'ุจุฏุงูุฉ ููุณู ุงูููุงุฏุฉ ุงูุฃูู',
                type: 'birth',
                priority: 'high'
            });
            
            const weaning1 = new Date(birth1Start);
            weaning1.setDate(weaning1.getDate() + lactationDays);
            events.push({
                date: new Date(weaning1),
                event: 'ูุทุงู ูุฌููุนุฉ 1',
                type: 'weaning',
                priority: 'medium'
            });
            
            // Second breeding season
            events.push({
                date: new Date(breeding2Start),
                event: 'ุจุฏุงูุฉ ููุณู ุงูุชูููุญ ุงูุซุงูู',
                type: 'breeding',
                priority: 'high'
            });
            
            const birth2Start = new Date(breeding2Start);
            birth2Start.setDate(birth2Start.getDate() + gestationDays);
            events.push({
                date: new Date(birth2Start),
                event: 'ุจุฏุงูุฉ ููุณู ุงูููุงุฏุฉ ุงูุซุงูู',
                type: 'birth',
                priority: 'high'
            });
            
            // Sort events by date
            events.sort((a, b) => a.date - b.date);
            
            displayBreedingSchedule(events);
            createProductionTimelineChart(events);
        }
        
        function displayBreedingSchedule(events) {
            const container = document.getElementById('breedingSchedule');
            if (!container) return;
            
            const eventIcons = {
                breeding: '๐',
                birth: '๐ฃ',
                weaning: '๐ฟ'
            };
            
            const eventColors = {
                high: '#e74c3c',
                medium: '#f39c12',
                low: '#2ecc71'
            };
            
            const eventsHTML = events.map(event => {
                const dateStr = event.date.toLocaleDateString('ar-EG', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                return `
                    <div style="margin: 8px 0; padding: 8px; background: white; border-radius: 4px; border-left: 4px solid ${eventColors[event.priority]};">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="font-weight: bold;">${eventIcons[event.type]} ${event.event}</span>
                            <span style="color: #666; font-size: 0.9em;">${dateStr}</span>
                        </div>
                    </div>
                `;
            }).join('');
            
            container.innerHTML = `
                <h4 style="margin-bottom: 10px; color: #2c3e50;">ุงูุฃุญุฏุงุซ ุงููุงุฏูุฉ:</h4>
                ${eventsHTML}
            `;
        }
        
        function createProductionTimelineChart(events) {
            const ctx = document.getElementById('productionTimelineChart');
            if (!ctx) return;
            
            if (charts.productionTimeline) {
                charts.productionTimeline.destroy();
            }
            
            // Create monthly production data
            const monthlyData = Array(12).fill(0);
            const ewes = parseInt(document.getElementById('ewes').value) || 30;
            const birthRate = parseFloat(document.getElementById('birthRate').value) || 150;
            const lambsPerBirth = parseFloat(document.getElementById('lambsPerBirth').value) || 1.3;
            
            events.filter(e => e.type === 'birth').forEach(event => {
                const month = event.date.getMonth();
                const expectedLambs = ewes * (birthRate / 100) * lambsPerBirth;
                monthlyData[month] += expectedLambs;
            });
            
            charts.productionTimeline = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['ููุงูุฑ', 'ูุจุฑุงูุฑ', 'ูุงุฑุณ', 'ุฃุจุฑูู', 'ูุงูู', 'ููููู', 'ููููู', 'ุฃุบุณุทุณ', 'ุณุจุชูุจุฑ', 'ุฃูุชูุจุฑ', 'ููููุจุฑ', 'ุฏูุณูุจุฑ'],
                    datasets: [{
                        label: 'ุนุฏุฏ ุงูููุงููุฏ ุงููุชููุนุฉ',
                        data: monthlyData,
                        backgroundColor: '#3498db',
                        borderColor: '#2980b9',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ุชูุฒูุน ุงูููุงููุฏ ุนูู ูุฏุงุฑ ุงูุนุงู'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return Math.round(value) + ' ููููุฏ';
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Sensitivity analysis functions
        function runSensitivityAnalysis() {
            const priceVar = parseFloat(document.getElementById('priceVariation').value) || 20;
            const feedCostVar = parseFloat(document.getElementById('feedCostVariation').value) || 25;
            const birthRateVar = parseFloat(document.getElementById('birthRateVariation').value) || 15;
            const mortalityVar = parseFloat(document.getElementById('mortalityVariation').value) || 10;
            const demandVar = parseFloat(document.getElementById('demandVariation').value) || 30;
            const monteCarloRuns = parseInt(document.getElementById('monteCarloRuns').value) || 1000;
            
            // Base values
            const baseProfit = parseFloat(document.getElementById('yearOneProfit').textContent.replace(/,/g, ''));
            const basePrice = parseFloat(document.getElementById('udheyaPrice').value);
            const baseFeedCost = parseFloat(document.getElementById('feedPriceTon').value);
            const baseBirthRate = parseFloat(document.getElementById('birthRate').value);
            const baseMortality = parseFloat(document.getElementById('mortalityRate').value);
            const baseDemand = parseFloat(document.getElementById('udheyaCustomers').value);
            
            // Tornado analysis
            const sensitivities = [];
            
            // Price sensitivity
            const highPrice = calculateSensitivityProfit('udheyaPrice', basePrice * (1 + priceVar/100));
            const lowPrice = calculateSensitivityProfit('udheyaPrice', basePrice * (1 - priceVar/100));
            sensitivities.push({
                variable: 'ุฃุณุนุงุฑ ุงูุจูุน',
                high: highPrice - baseProfit,
                low: lowPrice - baseProfit
            });
            
            // Feed cost sensitivity
            const highFeedCost = calculateSensitivityProfit('feedPriceTon', baseFeedCost * (1 + feedCostVar/100));
            const lowFeedCost = calculateSensitivityProfit('feedPriceTon', baseFeedCost * (1 - feedCostVar/100));
            sensitivities.push({
                variable: 'ุชูุงููู ุงูุนูู',
                high: highFeedCost - baseProfit,
                low: lowFeedCost - baseProfit
            });
            
            // Birth rate sensitivity
            const highBirthRate = calculateSensitivityProfit('birthRate', baseBirthRate * (1 + birthRateVar/100));
            const lowBirthRate = calculateSensitivityProfit('birthRate', baseBirthRate * (1 - birthRateVar/100));
            sensitivities.push({
                variable: 'ูุนุฏู ุงูููุงุฏุฉ',
                high: highBirthRate - baseProfit,
                low: lowBirthRate - baseProfit
            });
            
            // Demand sensitivity
            const highDemand = calculateSensitivityProfit('udheyaCustomers', baseDemand * (1 + demandVar/100));
            const lowDemand = calculateSensitivityProfit('udheyaCustomers', baseDemand * (1 - demandVar/100));
            sensitivities.push({
                variable: 'ุงูุทูุจ',
                high: highDemand - baseProfit,
                low: lowDemand - baseProfit
            });
            
            // Run Monte Carlo simulation
            const monteCarloResults = runMonteCarloSimulation(monteCarloRuns, {
                priceVar, feedCostVar, birthRateVar, mortalityVar, demandVar
            });
            
            // Display results
            createSensitivityChart(sensitivities);
            createMonteCarloChart(monteCarloResults);
            displayRiskAssessment(monteCarloResults, baseProfit);
        }
        
        function calculateSensitivityProfit(variableId, newValue) {
            const originalValue = document.getElementById(variableId).value;
            document.getElementById(variableId).value = newValue;
            calculateAll();
            const profit = parseFloat(document.getElementById('yearOneProfit').textContent.replace(/,/g, ''));
            document.getElementById(variableId).value = originalValue;
            calculateAll();
            return profit;
        }
        
        function runMonteCarloSimulation(runs, variations) {
            const results = [];
            const baseValues = {
                udheyaPrice: parseFloat(document.getElementById('udheyaPrice').value),
                feedPriceTon: parseFloat(document.getElementById('feedPriceTon').value),
                birthRate: parseFloat(document.getElementById('birthRate').value),
                mortalityRate: parseFloat(document.getElementById('mortalityRate').value),
                udheyaCustomers: parseFloat(document.getElementById('udheyaCustomers').value)
            };
            
            for (let i = 0; i < runs; i++) {
                // Generate random variations
                const priceMultiplier = 1 + (Math.random() - 0.5) * 2 * (variations.priceVar / 100);
                const feedCostMultiplier = 1 + (Math.random() - 0.5) * 2 * (variations.feedCostVar / 100);
                const birthRateMultiplier = 1 + (Math.random() - 0.5) * 2 * (variations.birthRateVar / 100);
                const mortalityMultiplier = 1 + (Math.random() - 0.5) * 2 * (variations.mortalityVar / 100);
                const demandMultiplier = 1 + (Math.random() - 0.5) * 2 * (variations.demandVar / 100);
                
                // Apply variations
                document.getElementById('udheyaPrice').value = baseValues.udheyaPrice * priceMultiplier;
                document.getElementById('feedPriceTon').value = baseValues.feedPriceTon * feedCostMultiplier;
                document.getElementById('birthRate').value = baseValues.birthRate * birthRateMultiplier;
                document.getElementById('mortalityRate').value = Math.max(0, baseValues.mortalityRate * mortalityMultiplier);
                document.getElementById('udheyaCustomers').value = Math.max(0, baseValues.udheyaCustomers * demandMultiplier);
                
                calculateAll();
                const profit = parseFloat(document.getElementById('yearOneProfit').textContent.replace(/,/g, ''));
                results.push(profit);
            }
            
            // Restore original values
            Object.entries(baseValues).forEach(([id, value]) => {
                document.getElementById(id).value = value;
            });
            calculateAll();
            
            return results;
        }
        
        function createSensitivityChart(sensitivities) {
            const ctx = document.getElementById('sensitivityChart');
            if (!ctx) return;
            
            if (charts.sensitivity) {
                charts.sensitivity.destroy();
            }
            
            const data = sensitivities.map(s => [s.low, s.high]);
            const labels = sensitivities.map(s => s.variable);
            
            charts.sensitivity = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'ุชุฃุซูุฑ ุณูุจู',
                            data: sensitivities.map(s => s.low),
                            backgroundColor: '#e74c3c'
                        },
                        {
                            label: 'ุชุฃุซูุฑ ุฅูุฌุงุจู',
                            data: sensitivities.map(s => s.high),
                            backgroundColor: '#2ecc71'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ุชุญููู ุงูุญุณุงุณูุฉ (ุฑุณู ุงูุฅุนุตุงุฑ)'
                        }
                    },
                    scales: {
                        x: {
                            stacked: false
                        },
                        y: {
                            ticks: {
                                callback: function(value) {
                                    return (value / 1000).toFixed(0) + 'ุฃูู';
                                }
                            }
                        }
                    }
                }
            });
        }
        
        function createMonteCarloChart(results) {
            const ctx = document.getElementById('monteCarloChart');
            if (!ctx) return;
            
            if (charts.monteCarlo) {
                charts.monteCarlo.destroy();
            }
            
            // Create histogram
            const bins = 20;
            const min = Math.min(...results);
            const max = Math.max(...results);
            const binSize = (max - min) / bins;
            const histogram = Array(bins).fill(0);
            const labels = [];
            
            for (let i = 0; i < bins; i++) {
                const binStart = min + i * binSize;
                const binEnd = binStart + binSize;
                labels.push((binStart / 1000).toFixed(0) + '-' + (binEnd / 1000).toFixed(0));
                
                results.forEach(result => {
                    if (result >= binStart && result < binEnd) {
                        histogram[i]++;
                    }
                });
            }
            
            charts.monteCarlo = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'ุชูุฑุงุฑ ุงููุชุงุฆุฌ',
                        data: histogram,
                        backgroundColor: '#3498db',
                        borderColor: '#2980b9',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ูุญุงูุงุฉ ูููุช ูุงุฑูู - ุชูุฒูุน ุงูุฃุฑุจุงุญ'
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'ุตุงูู ุงูุฑุจุญ (ุฃูู ุฌููู)'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'ุนุฏุฏ ูุฑุงุช ุงูุญุฏูุซ'
                            }
                        }
                    }
                }
            });
        }
        
        function displayRiskAssessment(results, baseProfit) {
            const container = document.getElementById('riskAssessment');
            if (!container) return;
            
            const profitable = results.filter(r => r > 0).length;
            const profitabilityPercentage = (profitable / results.length * 100).toFixed(1);
            
            const mean = results.reduce((sum, r) => sum + r, 0) / results.length;
            const sorted = results.sort((a, b) => a - b);
            const percentile5 = sorted[Math.floor(results.length * 0.05)];
            const percentile95 = sorted[Math.floor(results.length * 0.95)];
            const median = sorted[Math.floor(results.length * 0.5)];
            
            const worstCase = Math.min(...results);
            const bestCase = Math.max(...results);
            
            let riskLevel = 'ููุฎูุถ';
            let riskColor = '#2ecc71';
            
            if (profitabilityPercentage < 60) {
                riskLevel = 'ุนุงูู';
                riskColor = '#e74c3c';
            } else if (profitabilityPercentage < 80) {
                riskLevel = 'ูุชูุณุท';
                riskColor = '#f39c12';
            }
            
            container.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <div style="background: white; padding: 10px; border-radius: 6px; border-left: 4px solid ${riskColor};">
                        <h4 style="color: ${riskColor}; margin-bottom: 8px;">ูุณุชูู ุงููุฎุงุทุฑุฉ: ${riskLevel}</h4>
                        <p>ูุณุจุฉ ุงูุฑุจุญูุฉ: ${profitabilityPercentage}%</p>
                    </div>
                    
                    <div style="background: white; padding: 10px; border-radius: 6px;">
                        <h4 style="color: #2c3e50; margin-bottom: 8px;">ุงูููู ุงููุชููุนุฉ</h4>
                        <p>ุงููุชูุณุท: ${mean.toLocaleString()} ุฌููู</p>
                        <p>ุงููุณูุท: ${median.toLocaleString()} ุฌููู</p>
                    </div>
                    
                    <div style="background: white; padding: 10px; border-radius: 6px;">
                        <h4 style="color: #2c3e50; margin-bottom: 8px;">ูุทุงู ุงูุซูุฉ (90%)</h4>
                        <p>ุงูุญุฏ ุงูุฃุฏูู: ${percentile5.toLocaleString()}</p>
                        <p>ุงูุญุฏ ุงูุฃุนูู: ${percentile95.toLocaleString()}</p>
                    </div>
                    
                    <div style="background: white; padding: 10px; border-radius: 6px;">
                        <h4 style="color: #2c3e50; margin-bottom: 8px;">ุงูุณููุงุฑูููุงุช ุงููุชุทุฑูุฉ</h4>
                        <p style="color: #e74c3c;">ุงูุฃุณูุฃ: ${worstCase.toLocaleString()}</p>
                        <p style="color: #2ecc71;">ุงูุฃูุถู: ${bestCase.toLocaleString()}</p>
                    </div>
                </div>
                
                <div style="margin-top: 15px; padding: 10px; background: #e8f4f8; border-radius: 6px;">
                    <h4 style="color: #2c3e50; margin-bottom: 8px;">ุชูุตูุงุช ุฅุฏุงุฑุฉ ุงููุฎุงุทุฑ:</h4>
                    <ul style="margin: 0; padding-right: 20px;">
                        ${profitabilityPercentage < 70 ? '<li>ุงุนุชุจุฑ ุฒูุงุฏุฉ ุงูุงุญุชูุงุทูุงุช ุงูููุฏูุฉ</li>' : ''}
                        <li>ูุฑุงูุจุฉ ุฃุณุนุงุฑ ุงูุนูู ุจุงูุชุธุงู</li>
                        <li>ุชูููุน ูุตุงุฏุฑ ุงูุฅูุฑุงุฏุงุช</li>
                        <li>ูุถุน ุฎุทุฉ ููุทูุงุฑุฆ ุงูุจูุทุฑูุฉ</li>
                        ${profitabilityPercentage > 85 ? '<li style="color: #2ecc71;">ุงููุดุฑูุน ูุธูุฑ ูุฎุงุทุฑ ููุฎูุถุฉ ูุฑุจุญูุฉ ุนุงููุฉ</li>' : ''}
                    </ul>
                </div>
            `;
        }
        
        // Market Intelligence Functions
        function createPriceTrendsChart() {
            const ctx = document.getElementById('priceTrendsChart');
            if (!ctx) return;
            
            if (charts.priceeTrends) {
                charts.priceTrends.destroy();
            }
            
            const price2021 = parseFloat(document.getElementById('price2021').value) || 6500;
            const price2022 = parseFloat(document.getElementById('price2022').value) || 7000;
            const price2023 = parseFloat(document.getElementById('price2023').value) || 7500;
            const currentPrice = parseFloat(document.getElementById('udheyaPrice').value) || 8000;
            
            // Generate seasonal pattern
            const basePrice = currentPrice;
            const ramadanIncrease = parseFloat(document.getElementById('ramadanPriceIncrease').value) || 15;
            const hajjIncrease = parseFloat(document.getElementById('hajjPriceIncrease').value) || 25;
            const summerDecrease = parseFloat(document.getElementById('summerPriceDecrease').value) || 10;
            
            const monthlyPrices = [
                basePrice * (1 - summerDecrease/100), // Jan
                basePrice * (1 - summerDecrease/100), // Feb
                basePrice, // Mar
                basePrice * (1 + ramadanIncrease/100), // Apr (Ramadan)
                basePrice, // May
                basePrice * (1 - summerDecrease/100), // Jun
                basePrice * (1 + hajjIncrease/100), // Jul (Hajj)
                basePrice, // Aug
                basePrice, // Sep
                basePrice, // Oct
                basePrice, // Nov
                basePrice * (1 + hajjIncrease/100) // Dec (Hajj)
            ];
            
            charts.priceTrends = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['ููุงูุฑ', 'ูุจุฑุงูุฑ', 'ูุงุฑุณ', 'ุฃุจุฑูู', 'ูุงูู', 'ููููู', 'ููููู', 'ุฃุบุณุทุณ', 'ุณุจุชูุจุฑ', 'ุฃูุชูุจุฑ', 'ููููุจุฑ', 'ุฏูุณูุจุฑ'],
                    datasets: [
                        {
                            label: '2021',
                            data: monthlyPrices.map(p => price2021 * (p / basePrice)),
                            borderColor: '#95a5a6',
                            backgroundColor: 'rgba(149, 165, 166, 0.1)',
                            tension: 0.4
                        },
                        {
                            label: '2022',
                            data: monthlyPrices.map(p => price2022 * (p / basePrice)),
                            borderColor: '#3498db',
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            tension: 0.4
                        },
                        {
                            label: '2023',
                            data: monthlyPrices.map(p => price2023 * (p / basePrice)),
                            borderColor: '#e74c3c',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            tension: 0.4
                        },
                        {
                            label: '2024 (ุชููุน)',
                            data: monthlyPrices,
                            borderColor: '#2ecc71',
                            backgroundColor: 'rgba(46, 204, 113, 0.1)',
                            tension: 0.4,
                            borderWidth: 3
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ุงุชุฌุงูุงุช ุฃุณุนุงุฑ ุงูุฃุถุงุญู'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString() + ' ุฌููู';
                                }
                            }
                        }
                    }
                }
            });
        }
        
        function createDemandForecastChart() {
            const ctx = document.getElementById('demandForecastChart');
            if (!ctx) return;
            
            if (charts.demandForecast) {
                charts.demandForecast.destroy();
            }
            
            const totalFamilies = parseFloat(document.getElementById('totalFamilies').value) || 5000;
            const sacrificePercentage = parseFloat(document.getElementById('sacrificePercentage').value) || 70;
            const populationGrowth = parseFloat(document.getElementById('populationGrowth').value) || 2.5;
            const purchasingPowerGrowth = parseFloat(document.getElementById('purchasingPowerGrowth').value) || 5;
            
            const currentDemand = totalFamilies * (sacrificePercentage / 100);
            const years = ['2024', '2025', '2026', '2027', '2028'];
            const demandProjection = [];
            
            for (let i = 0; i < 5; i++) {
                const populationFactor = Math.pow(1 + populationGrowth/100, i);
                const purchasingFactor = Math.pow(1 + purchasingPowerGrowth/100, i);
                const demand = currentDemand * populationFactor * Math.min(purchasingFactor, 1.3); // Cap purchasing power effect
                demandProjection.push(Math.round(demand));
            }
            
            charts.demandForecast = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: years,
                    datasets: [{
                        label: 'ุงูุทูุจ ุงููุชููุน',
                        data: demandProjection,
                        backgroundColor: '#9b59b6',
                        borderColor: '#8e44ad',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ุชููุน ุงูุทูุจ ุนูู ุงูุฃุถุงุญู'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString() + ' ุฃุถุญูุฉ';
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Compliance Functions
        function initializeCompliance() {
            const basicDocs = [
                { name: 'ุงูุณุฌู ุงูุชุฌุงุฑู', completed: false, cost: 2000, renewal: 'ุณููู' },
                { name: 'ุงูุจุทุงูุฉ ุงูุถุฑูุจูุฉ', completed: false, cost: 500, renewal: 'ูุฑุฉ ูุงุญุฏุฉ' },
                { name: 'ุฑุฎุตุฉ ูุฒุงููุฉ ุงููุดุงุท', completed: false, cost: 5000, renewal: 'ุณููู' },
                { name: 'ุชุฑุฎูุต ุจูุฆู', completed: false, cost: 8000, renewal: '3 ุณููุงุช' },
                { name: 'ุฑุฎุตุฉ ุจูุงุก', completed: false, cost: 15000, renewal: 'ูุฑุฉ ูุงุญุฏุฉ' }
            ];
            
            const qualityDocs = [
                { name: 'ุดูุงุฏุฉ ุงูุฐุจุญ ุงูุญูุงู', completed: false, cost: 15000, renewal: 'ุณููู' },
                { name: 'ISO 22000', completed: false, cost: 50000, renewal: '3 ุณููุงุช' },
                { name: 'ุดูุงุฏุฉ HACCP', completed: false, cost: 25000, renewal: 'ุณููู' },
                { name: 'ุชุฑุฎูุต ูุฒุงุฑุฉ ุงูุตุญุฉ', completed: false, cost: 10000, renewal: 'ุณููู' },
                { name: 'ุดูุงุฏุฉ ุฌูุฏุฉ ูุตุฑูุฉ', completed: false, cost: 20000, renewal: '3 ุณููุงุช' }
            ];
            
            const exportDocs = [
                { name: 'ุฑุฎุตุฉ ุชุตุฏูุฑ', completed: false, cost: 25000, renewal: 'ุณููู' },
                { name: 'ุดูุงุฏุฉ ููุดุฃ ูุตุฑู', completed: false, cost: 5000, renewal: 'ููู ุดุญูุฉ' },
                { name: 'ุดูุงุฏุฉ ุจูุทุฑูุฉ', completed: false, cost: 3000, renewal: 'ููู ุดุญูุฉ' },
                { name: 'ุชุฑุฎูุต ุฌูุงุฑู', completed: false, cost: 8000, renewal: 'ุณููู' },
                { name: 'ุดูุงุฏุฉ ูุทุงุจูุฉ ุฎููุฌูุฉ', completed: false, cost: 15000, renewal: 'ุณููู' }
            ];
            
            displayDocumentChecklist('basicDocuments', basicDocs);
            displayDocumentChecklist('qualityDocuments', qualityDocs);
            displayDocumentChecklist('exportDocuments', exportDocs);
            
            updateComplianceChart();
        }
        
        function displayDocumentChecklist(containerId, documents) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            container.innerHTML = documents.map((doc, index) => `
                <div style="margin: 5px 0; padding: 8px; background: white; border-radius: 4px; border: 1px solid #ddd;">
                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                        <input type="checkbox" onchange="toggleDocumentStatus('${containerId}', ${index})" style="margin: 0;">
                        <div style="flex: 1;">
                            <div style="font-weight: bold; font-size: 0.8em;">${doc.name}</div>
                            <div style="font-size: 0.7em; color: #666;">${doc.cost.toLocaleString()} ุฌููู - ${doc.renewal}</div>
                        </div>
                    </label>
                </div>
            `).join('');
        }
        
        function toggleDocumentStatus(containerId, index) {
            // This would update the document status in a real application
            updateComplianceChart();
        }
        
        function updateComplianceChart() {
            const ctx = document.getElementById('complianceChart');
            if (!ctx) return;
            
            if (charts.compliance) {
                charts.compliance.destroy();
            }
            
            // Count completed documents (this would be dynamic in a real app)
            const totalDocs = 15;
            const completedDocs = Math.floor(Math.random() * 8) + 3; // Simulate some completed
            const pendingDocs = totalDocs - completedDocs;
            
            charts.compliance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['ููุชูู', 'ูุนูู'],
                    datasets: [{
                        data: [completedDocs, pendingDocs],
                        backgroundColor: ['#2ecc71', '#e74c3c']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ุญุงูุฉ ุงููุซุงุฆู'
                        }
                    }
                }
            });
            
            // Update summary
            const summary = document.getElementById('complianceSummary');
            if (summary) {
                const completionRate = (completedDocs / totalDocs * 100).toFixed(1);
                summary.innerHTML = `
                    <div style="margin: 5px 0;"><strong>ูุณุจุฉ ุงูุฅูุฌุงุฒ:</strong> ${completionRate}%</div>
                    <div style="margin: 5px 0;"><strong>ููุชูู:</strong> ${completedDocs} ูู ${totalDocs}</div>
                    <div style="margin: 5px 0;"><strong>ูุชุจูู:</strong> ${pendingDocs} ูุซููุฉ</div>
                    <div style="margin: 10px 0; padding: 8px; background: ${completionRate > 80 ? '#d4edda' : completionRate > 60 ? '#fff3cd' : '#f8d7da'}; border-radius: 4px; font-size: 0.8em;">
                        ${completionRate > 80 ? 'โ ูุณุชูู ููุชุงุฒ ูู ุงูุงูุชุฒุงู' : 
                          completionRate > 60 ? 'โ๏ธ ูุญุชุงุฌ ุฅูู ุชุญุณูู' : 
                          'โ ูุชุทูุจ ุนูู ููุฑู'}
                    </div>
                `;
            }
        }
        
        // Operational Tools Functions
        function simulateOutbreak() {
            const diseaseType = document.getElementById('diseaseType').value;
            const infectionRate = parseFloat(document.getElementById('infectionRate').value) || 30;
            const diseaseMortality = parseFloat(document.getElementById('diseaseMortality').value) || 15;
            const treatmentCost = parseFloat(document.getElementById('treatmentCost').value) || 500;
            const weightLoss = parseFloat(document.getElementById('weightLoss').value) || 20;
            const flockSize = parseFloat(document.getElementById('initialSheep').value) || 50;
            const animalValue = parseFloat(document.getElementById('sheepCost').value) || 3500;
            
            const infectedAnimals = Math.round(flockSize * infectionRate / 100);
            const deaths = Math.round(infectedAnimals * diseaseMortality / 100);
            const recoveredAnimals = infectedAnimals - deaths;
            
            const treatmentCosts = infectedAnimals * treatmentCost;
            const mortalityLoss = deaths * animalValue;
            const weightLossValue = recoveredAnimals * animalValue * (weightLoss / 100);
            const totalLoss = treatmentCosts + mortalityLoss + weightLossValue;
            
            const diseaseNames = {
                ppr: 'ุทุงุนูู ุงููุฌุชุฑุงุช ุงูุตุบูุฑุฉ',
                fmd: 'ุงูุญูู ุงูููุงุนูุฉ',
                parasites: 'ุงูุทููููุงุช',
                respiratory: 'ุฃูุฑุงุถ ุชููุณูุฉ'
            };
            
            const results = document.getElementById('outbreakResults');
            results.innerHTML = `
                <h4>ุชุฃุซูุฑ ุชูุดู ${diseaseNames[diseaseType]}:</h4>
                <div style="margin: 8px 0; padding: 6px; background: white; border-radius: 4px;">
                    <strong>ุนุฏุฏ ุงูุญููุงูุงุช ุงููุตุงุจุฉ:</strong> ${infectedAnimals} (${infectionRate}%)
                </div>
                <div style="margin: 8px 0; padding: 6px; background: white; border-radius: 4px;">
                    <strong>ุนุฏุฏ ุงููููู:</strong> ${deaths} ุฑุฃุณ
                </div>
                <div style="margin: 8px 0; padding: 6px; background: white; border-radius: 4px;">
                    <strong>ุชูููุฉ ุงูุนูุงุฌ:</strong> ${treatmentCosts.toLocaleString()} ุฌููู
                </div>
                <div style="margin: 8px 0; padding: 6px; background: white; border-radius: 4px;">
                    <strong>ุฎุณุงุฆุฑ ุงููููู:</strong> ${mortalityLoss.toLocaleString()} ุฌููู
                </div>
                <div style="margin: 8px 0; padding: 6px; background: white; border-radius: 4px;">
                    <strong>ุฎุณุงุฆุฑ ููุฏุงู ุงููุฒู:</strong> ${weightLossValue.toLocaleString()} ุฌููู
                </div>
                <div style="margin: 8px 0; padding: 8px; background: #f8d7da; border-radius: 4px; font-weight: bold; color: #721c24;">
                    <strong>ุฅุฌูุงูู ุงูุฎุณุงุฆุฑ:</strong> ${totalLoss.toLocaleString()} ุฌููู
                </div>
                <div style="margin: 8px 0; padding: 6px; background: #e8f4f8; border-radius: 4px; font-size: 0.8em;">
                    <strong>ุงูุชูุตูุงุช:</strong>
                    <ul style="margin: 5px 0; padding-right: 15px;">
                        <li>ุฒูุงุฏุฉ ุจุฑูุงูุฌ ุงูุชุญุตููุงุช ุงูููุงุฆูุฉ</li>
                        <li>ุชุญุณูู ุงููุธุงูุฉ ูุงูุชุทููุฑ</li>
                        <li>ุฒูุงุฏุฉ ุงูุงุญุชูุงุทู ุงูููุฏู ุจู${Math.round(totalLoss * 0.1).toLocaleString()} ุฌููู</li>
                    </ul>
                </div>
            `;
        }
        
        function optimizeSchedule() {
            const dailyHours = parseFloat(document.getElementById('dailyWorkHours').value) || 8;
            const workDays = parseFloat(document.getElementById('workDaysPerWeek').value) || 6;
            const workers = parseFloat(document.getElementById('workers').value) || 2;
            const workerSalary = parseFloat(document.getElementById('workerSalary').value) || 3000;
            const overtimeRate = parseFloat(document.getElementById('overtimeRate').value) || 50;
            
            const weeklyHours = dailyHours * workDays;
            const monthlyHours = weeklyHours * 4.33;
            const overtimeThreshold = 48; // Egyptian labor law
            const overtimeHours = Math.max(0, weeklyHours - overtimeThreshold);
            
            const regularPay = workerSalary;
            const overtimePay = (workerSalary / (overtimeThreshold * 4.33)) * overtimeHours * 4.33 * (1 + overtimeRate/100);
            const totalMonthlyCost = (regularPay + overtimePay) * workers;
            
            const efficiency = Math.min(100, (weeklyHours / 60) * 100); // Optimal around 60 hours/week
            
            const results = document.getElementById('scheduleResults');
            results.innerHTML = `
                <h4>ุชุญููู ุฌุฏููุฉ ุงูุนูู:</h4>
                <div style="margin: 8px 0; padding: 6px; background: white; border-radius: 4px;">
                    <strong>ุณุงุนุงุช ุงูุนูู ุงูุฃุณุจูุนูุฉ:</strong> ${weeklyHours} ุณุงุนุฉ
                </div>
                <div style="margin: 8px 0; padding: 6px; background: white; border-radius: 4px;">
                    <strong>ุณุงุนุงุช ุฅุถุงููุฉ:</strong> ${overtimeHours.toFixed(1)} ุณุงุนุฉ/ุฃุณุจูุน
                </div>
                <div style="margin: 8px 0; padding: 6px; background: white; border-radius: 4px;">
                    <strong>ุงูุชูููุฉ ุงูุดูุฑูุฉ:</strong> ${totalMonthlyCost.toLocaleString()} ุฌููู
                </div>
                <div style="margin: 8px 0; padding: 6px; background: white; border-radius: 4px;">
                    <strong>ููุงุกุฉ ุงูุฌุฏููุฉ:</strong> ${efficiency.toFixed(1)}%
                </div>
                <div style="margin: 8px 0; padding: 6px; background: ${efficiency > 85 ? '#d4edda' : efficiency > 70 ? '#fff3cd' : '#f8d7da'}; border-radius: 4px; font-size: 0.8em;">
                    ${efficiency > 85 ? 'โ ุฌุฏููุฉ ูุซูู' : 
                      efficiency > 70 ? 'โ๏ธ ูููู ุชุญุณูููุง' : 
                      'โ ุชุญุชุงุฌ ุฅุนุงุฏุฉ ุชูุธูู'}
                </div>
            `;
        }
        
        function updateCurrencyConverter() {
            const egpAmount = parseFloat(document.getElementById('egpAmount').value) || 0;
            const usdRate = parseFloat(document.getElementById('usdRate').value) || 31;
            const eurRate = parseFloat(document.getElementById('eurRate').value) || 33;
            
            document.getElementById('usdAmount').value = (egpAmount / usdRate).toFixed(2);
            document.getElementById('eurAmount').value = (egpAmount / eurRate).toFixed(2);
        }
        
        // Initialize currency converter
        ['egpAmount', 'usdRate', 'eurRate'].forEach(id => {
            document.getElementById(id)?.addEventListener('input', updateCurrencyConverter);
        });
        
        // Initial calculation
        calculateAll();
        
        // Update non-Eid sales when Eid sales changes
        document.getElementById('eidSales').addEventListener('input', function() {
            document.getElementById('nonEidSales').value = 100 - this.value;
        });
        
        // Update credit customers when cash customers changes
        document.getElementById('cashCustomers').addEventListener('input', function() {
            document.getElementById('creditCustomers').value = 100 - this.value;
        });
        
        // Update rams needed when ewes changes
        document.getElementById('ewes').addEventListener('input', function() {
            document.getElementById('ramsNeeded').value = Math.ceil(this.value / 25);
        });
    </script>
</body>
</html>
